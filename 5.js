(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{Ds32:function(t,e,i){!function(t,i){i(e)}(0,(function(t){"use strict";var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},e(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n=function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e,i,n){return new(i||(i=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function r(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!((o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return a}function l(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function c(t,e){if(p(t)||p(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t[i],o=e[i];p(o)&&p(n)&&!h(o)&&!h(n)?c(n,o):g(e[i])&&(t[i]=e[i])}}function u(t){if(!p(t)||!h(t))return t;var e;for(var i in e=h(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];p(n)?e[i]=u(n):e[i]=n}return e}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t){return"function"==typeof t}function p(t){return"object"==typeof t}function v(t){return"number"==typeof t&&!isNaN(t)}function g(t){return null!=t}function f(t){return"string"==typeof t}var m,y,_,x,S,C,b,w,I,E=/\\(\\)?/g,T=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function D(t,e,i){if(g(t)){var n=[];e.replace(T,(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=t;return g(e[1])?o=e[2].replace(E,"$1"):g(e[0])&&(o=e[0].trim()),n.push(o),""}));for(var o=t,r=0,a=n.length;g(o)&&r<a;)o=null==o?void 0:o[n[r++]];return g(o)?o:null!=i?i:"--"}return null!=i?i:"--"}function M(t,e,i){var n=t.format(new Date(e)).split(", "),o=n[0].split("/"),r=n[1].split(":"),a={YYYY:o[2],MM:o[0],DD:o[1],HH:"24"===r[0]?"00":r[0],mm:r[1],ss:r[2]};return i.replace(/YYYY|MM|DD|HH|mm|ss/g,(function(t){return a[t]}))}function P(t,e){var i=+t;return v(i)?i.toFixed(null!=e?e:2):"".concat(i)}function k(t){var e=+t;return v(e)?t>1e9?"".concat(+(e/1e9).toFixed(3),"B"):t>1e6?"".concat(+(e/1e6).toFixed(3),"M"):t>1e3?"".concat(+(e/1e3).toFixed(3),"K"):"".concat(t):"--"}!function(t){t.Dashed="dashed",t.Solid="solid"}(m||(m={})),function(t){t.Stroke="stroke",t.Fill="fill",t.StrokeFill="stroke_fill"}(y||(y={})),function(t){t.Always="always",t.FollowCross="follow_cross",t.None="none"}(_||(_={})),function(t){t.Standard="standard",t.Rect="rect"}(x||(x={})),function(t){t.Left="left",t.Middle="middle",t.Right="right"}(S||(S={})),function(t){t.CandleSolid="candle_solid",t.CandleStroke="candle_stroke",t.CandleUpStroke="candle_up_stroke",t.CandleDownStroke="candle_down_stroke",t.Ohlc="ohlc",t.Area="area"}(C||(C={})),function(t){t.Left="left",t.Right="right"}(b||(b={})),function(t){t.Normal="normal",t.Percentage="percentage",t.Log="log"}(w||(w={})),function(t){t[t.Tooltip=0]="Tooltip",t[t.Crosshair=1]="Crosshair",t[t.XAxis=2]="XAxis"}(I||(I={}));var A,F="en-US";!function(t){t.OnZoom="onZoom",t.OnScroll="onScroll",t.OnVisibleRangeChange="onVisibleRangeChange",t.OnTooltipIconClick="onTooltipIconClick",t.OnCrosshairChange="onCrosshairChange",t.OnPaneDrag="onPaneDrag"}(A||(A={}));var L,R=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){var e;(null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1)<0&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){var e;if(void 0!==t){var i=null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}(),B=new(function(){function t(){this._baseId=1}return t.prototype.next=function(t){var e=(new Date).getTime();return e===this._prevIdTimestamp?++this._baseId:this._baseId=1,this._prevIdTimestamp=e,"".concat(null!=t?t:"").concat(e,"_").concat(this._baseId)},t}());function N(t){return B.next(t)}function O(t,e){var i,n=document.createElement(t),o=null!=e?e:{};for(var r in o)n.style[r]=null!==(i=o[r])&&void 0!==i?i:"";return n}function V(t){var e,i,n;return null!==(n=null===(i=null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===i?void 0:i.devicePixelRatio)&&void 0!==n?n:2}function W(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function z(t,e,i,n){if(void 0===L){var o=document.createElement("canvas"),r=V(o);(L=o.getContext("2d")).scale(r,r)}return L.font=W(e,i,n),Math.round(L.measureText(t).width)}function Y(t,e,i){var n=0,o=0;for(o=t.length-1;n!==o;){var r=Math.floor((o+n)/2),a=o-n,s=t[r][e];if(i===t[n][e])return n;if(i===t[o][e])return o;if(i===s)return r;if(i>s?n=r:o=r,a<=2)break}return n}function X(t,e){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),+(+t).toFixed(e)}function H(t,e,i){var n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return t.forEach((function(t){var o,r;n[0]=Math.max(null!==(o=t[e])&&void 0!==o?o:t,n[0]),n[1]=Math.min(null!==(r=t[i])&&void 0!==r?r:t,n[1])})),n}function j(t){return Math.log(t)/Math.log(10)}function G(t){return Math.pow(10,t)}var U,Z=1,q=50,K=6,J=50,$=function(){function t(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=K,this._offsetRightDistance=J,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0},this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return t.prototype._calcGapBarSpace=function(){var t=Math.floor(.82*this._barSpace),e=Math.floor(this._barSpace),i=Math.min(t,e-1);return Math.max(1,i)},t.prototype.adjustVisibleRange=function(){var t,e=this._chartStore.getDataList(),i=e.length,n=this._totalBarSpace/this._barSpace,o=n-Math.min(this._minVisibleBarCount.left,i);this._offsetRightBarCount>o&&(this._offsetRightBarCount=o);var r=-i+Math.min(this._minVisibleBarCount.right,i);this._offsetRightBarCount<r&&(this._offsetRightBarCount=r);var a=Math.round(this._offsetRightBarCount+i+.5);a>i&&(a=i);var s=Math.round(a-n)-1;if(s<0&&(s=0),this._visibleRange={from:s,to:a},this._chartStore.getActionStore().execute(A.OnVisibleRangeChange,{from:s,to:a}),this._chartStore.adjustVisibleDataList(),0===s&&this._more&&!this._loading&&null!==this._loadMoreCallback){this._loading=!0;var l=e[0];this._loadMoreCallback(null!==(t=null==l?void 0:l.timestamp)&&void 0!==t?t:null)}},t.prototype.setMore=function(t){return this._more=t,this},t.prototype.setLoading=function(t){return this._loading=t,this},t.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},t.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};void 0!==t&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}return i},t.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);null!==e&&(this._dateTimeFormat=e)},t.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},t.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},t.prototype.setBarSpace=function(t,e){t<Z||t>q||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),null==e||e(),this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},t.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0)),this},t.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=t,this._offsetRightBarCount=t/this._barSpace,null!=e&&e&&(this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},t.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},t.prototype.getOffsetRightDistance=function(){return this._offsetRightDistance},t.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},t.prototype.setOffsetRightBarCount=function(t){return this._offsetRightBarCount=t,this},t.prototype.setLeftMinVisibleBarCount=function(t){return this._minVisibleBarCount.left=t,this},t.prototype.setRightMinVisibleBarCount=function(t){return this._minVisibleBarCount.right=t,this},t.prototype.getVisibleRange=function(){return this._visibleRange},t.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},t.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace;this._chartStore.getActionStore().execute(A.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-e,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},t.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._chartStore.getDataList()[t])&&void 0!==e?e:null},t.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,i=(this._totalBarSpace-t)/this._barSpace,n=e+this._offsetRightBarCount-i;return Math.round(1e6*n)/1e6},t.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return null!==(e=null==i?void 0:i.timestamp)&&void 0!==e?e:null},t.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return 0===e.length?0:Y(e,"timestamp",t)},t.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length+this._offsetRightBarCount-t;return this._totalBarSpace-(e-.5)*this._barSpace},t.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},t.prototype.zoom=function(t,e){var i=this;if(this._zoomEnabled){if(void 0===(null==e?void 0:e.x)){var n=this._chartStore.getCrosshairStore().get();e={x:void 0!==(null==n?void 0:n.x)?n.x:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(A.OnZoom);var o=this.coordinateToFloatIndex(e.x),r=this._barSpace+t*(this._barSpace/10);this.setBarSpace(r,(function(){i._offsetRightBarCount+=o-i.coordinateToFloatIndex(null==e?void 0:e.x)}))}},t.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},t.prototype.getZoomEnabled=function(){return this._zoomEnabled},t.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},t.prototype.getScrollEnabled=function(){return this._scrollEnabled},t.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},t.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0}},t}();function Q(t,e,i,n,o){var r,a,s,l=e.result,c=e.figures,u=e.styles,h=D(u,"circles",n.circles),d=h.length,p=D(u,"bars",n.bars),v=p.length,f=D(u,"lines",n.lines),m=f.length,y=0,_=0,x=0,S=0;c.forEach((function(c){var u,C,b,w;switch(c.type){case"circle":r=h[y%d],a=r.style,s=r.noChangeColor,S=y,y++;break;case"bar":r=p[_%v],a=r.style,s=r.noChangeColor,S=_,_++;break;case"line":r=f[x%m],a=r.style,s=r.color,S=x,x++}if(g(r)){var I={prev:{kLineData:t[i-1],indicatorData:l[i-1]},current:{kLineData:t[i],indicatorData:l[i]},next:{kLineData:t[i+1],indicatorData:l[i+1]}},E=null!==(C=null===(u=c.styles)||void 0===u?void 0:u.call(c,I,e,n))&&void 0!==C?C:{style:a,color:s};o(c,{style:null!==(b=E.style)&&void 0!==b?b:a,color:null!==(w=E.color)&&void 0!==w?w:s},r,S)}}))}!function(t){t.Normal="normal",t.Price="price",t.Volume="volume"}(U||(U={}));var tt=function(){function t(t){this.result=[],this._precisionFlag=!1;var e=t.name,i=t.shortName,n=t.series,o=t.calcParams,r=t.figures,a=t.precision,s=t.shouldOhlc,l=t.shouldFormatBigNumber,c=t.visible,u=t.minValue,h=t.maxValue,d=t.styles,p=t.extendData,v=t.regenerateFigures,g=t.createTooltipDataSource,f=t.draw;this.name=e,this.shortName=null!=i?i:e,this.series=null!=n?n:U.Normal,this.precision=null!=a?a:4,this.calcParams=null!=o?o:[],this.figures=null!=r?r:[],this.shouldOhlc=null!=s&&s,this.shouldFormatBigNumber=null!=l&&l,this.visible=null==c||c,this.minValue=null!=u?u:null,this.maxValue=null!=h?h:null,this.styles=null!=d?d:null,this.extendData=p,this.regenerateFigures=null!=v?v:null,this.createTooltipDataSource=null!=g?g:null,this.draw=null!=f?f:null}return t.prototype.setShortName=function(t){return this.shortName!==t&&(this.shortName=t,!0)},t.prototype.setSeries=function(t){return this.series!==t&&(this.series=t,!0)},t.prototype.setPrecision=function(t,e){var i=null!=e&&e,n=Math.floor(t);return!(!(n!==this.precision&&t>=0)||i&&(!i||this._precisionFlag))&&(this.precision=n,i||(this._precisionFlag=!0),!0)},t.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=null!==(i=null===(e=this.regenerateFigures)||void 0===e?void 0:e.call(this,t))&&void 0!==i?i:this.figures,!0},t.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t&&(this.shouldOhlc=t,!0)},t.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t&&(this.shouldFormatBigNumber=t,!0)},t.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},t.prototype.setStyles=function(t){return this.styles!==t&&(this.styles=t,!0)},t.prototype.setExtendData=function(t){return this.extendData!==t&&(this.extendData=t,!0)},t.prototype.setFigures=function(t){return this.figures!==t&&(this.figures=t,!0)},t.prototype.setMinValue=function(t){return this.minValue!==t&&(this.minValue=t,!0)},t.prototype.setMaxValue=function(t){return this.maxValue!==t&&(this.maxValue=t,!0)},t.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t&&(this.regenerateFigures=t,!0)},t.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t&&(this.createTooltipDataSource=t,!0)},t.prototype.setDraw=function(t){return this.draw!==t&&(this.draw=t,!0)},t.prototype.calcIndicator=function(t){return o(this,void 0,void 0,(function(){var e;return r(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},t.extend=function(e){return function(t){function n(){return t.call(this,e)||this}return i(n,t),n.prototype.calc=function(t,i){return e.calc(t,i)},n}(t)},t}(),et={name:"AVP",shortName:"AVP",series:U.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var n,o,r={},a=null!==(n=null==t?void 0:t.turnover)&&void 0!==n?n:0,s=null!==(o=null==t?void 0:t.volume)&&void 0!==o?o:0;return e+=a,0!==(i+=s)&&(r.avp=e/i),r}))}},it={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s=t.prev,l=t.current,c=null!==(o=null===(n=s.indicatorData)||void 0===n?void 0:n.ao)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=l.indicatorData)||void 0===r?void 0:r.ao)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return{color:u>c?D(e.styles,"bars[0].upColor",i.bars[0].upColor):D(e.styles,"bars[0].downColor",i.bars[0].downColor),style:u>c?"stroke":"fill"}}}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=0;return t.map((function(e,l){var c={},u=(e.low+e.high)/2;if(o+=u,r+=u,l>=i[0]-1){a=o/i[0];var h=t[l-(i[0]-1)];o-=(h.low+h.high)/2}return l>=i[1]-1&&(s=r/i[1],h=t[l-(i[1]-1)],r-=(h.low+h.high)/2),l>=n-1&&(c.ao=a-s),c}))}},nt={name:"BOLL",shortName:"BOLL",series:U.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0;return t.map((function(e,r){var a=e.close,s={};if(o+=a,r>=n){s.mid=o/i[0];var l=function(t,e){var i=t.length,n=0;return t.forEach((function(t){var i=t.close-e;n+=i*i})),n=Math.abs(n),Math.sqrt(n/i)}(t.slice(r-n,r+1),s.mid);s.up=s.mid+i[1]*l,s.dn=s.mid-i[1]*l,o-=t[r-n].close}return s}))}},ot={name:"BBI",shortName:"BBI",series:U.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max.apply(Math,l([],s(i),!1)),o=[],r=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var n;o[i]=(null!==(n=o[i])&&void 0!==n?n:0)+l,a>=e-1&&(r[i]=o[i]/e,o[i]-=t[a-(e-1)].close)})),a>=n-1){var c=0;r.forEach((function(t){c+=t})),s.bbi=c/4}return s}))}},rt={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0,r=[];return t.map((function(e,a){var s={},l=(e.high+e.low+e.close)/3;if(o+=l,r.push(l),a>=n){var c=o/i[0],u=r.slice(a-n,a+1),h=0;u.forEach((function(t){h+=Math.abs(t-c)}));var d=h/i[0];s.cci=0!==d?(l-c)/d/.015:0;var p=(t[a-n].high+t[a-n].low+t[a-n].close)/3;o-=p}return s}))}},at={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.ceil(i[1]/2.5+1),o=Math.ceil(i[2]/2.5+1),r=Math.ceil(i[3]/2.5+1),a=Math.ceil(i[4]/2.5+1),s=0,l=[],c=0,u=[],h=0,d=[],p=0,v=[],g=[];return t.forEach((function(e,f){var m,y,_,x,S,C={},b=null!==(m=t[f-1])&&void 0!==m?m:e,w=(b.high+b.close+b.low+b.open)/4,I=Math.max(0,e.high-w),E=Math.max(0,w-e.low);f>=i[0]-1&&(C.cr=0!==E?I/E*100:0,s+=C.cr,c+=C.cr,h+=C.cr,p+=C.cr,f>=i[0]+i[1]-2&&(l.push(s/i[1]),f>=i[0]+i[1]+n-3&&(C.ma1=l[l.length-1-n]),s-=null!==(y=g[f-(i[1]-1)].cr)&&void 0!==y?y:0),f>=i[0]+i[2]-2&&(u.push(c/i[2]),f>=i[0]+i[2]+o-3&&(C.ma2=u[u.length-1-o]),c-=null!==(_=g[f-(i[2]-1)].cr)&&void 0!==_?_:0),f>=i[0]+i[3]-2&&(d.push(h/i[3]),f>=i[0]+i[3]+r-3&&(C.ma3=d[d.length-1-r]),h-=null!==(x=g[f-(i[3]-1)].cr)&&void 0!==x?x:0),f>=i[0]+i[4]-2&&(v.push(p/i[4]),f>=i[0]+i[4]+a-3&&(C.ma4=v[v.length-1-a]),p-=null!==(S=g[f-(i[4]-1)].cr)&&void 0!==S?S:0)),g.push(C)})),g}},st={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var c,u={},h=e.close;o+=h,r+=h;var d=0,p=0;if(l>=i[0]-1&&(d=o/i[0],o-=t[l-(i[0]-1)].close),l>=i[1]-1&&(p=r/i[1],r-=t[l-(i[1]-1)].close),l>=n-1){var v=d-p;u.dma=v,a+=v,l>=n+i[2]-2&&(u.ama=a/i[2],a-=null!==(c=s[l-(i[2]-1)].dma)&&void 0!==c?c:0)}s.push(u)})),s}},lt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=0,l=0,c=0,u=0,h=[];return t.forEach((function(e,d){var p,v,g={},f=null!==(p=t[d-1])&&void 0!==p?p:e,m=f.close,y=e.high,_=e.low,x=y-_,S=Math.abs(y-m),C=Math.abs(m-_),b=y-f.high,w=f.low-_,I=Math.max(Math.max(x,S),C),E=b>0&&b>w?b:0,T=w>0&&w>b?w:0;if(n+=I,o+=E,r+=T,d>=i[0]-1){d>i[0]-1?(a=a-a/i[0]+I,s=s-s/i[0]+E,l=l-l/i[0]+T):(a=n,s=o,l=r);var D=0,M=0;0!==a&&(D=100*s/a,M=100*l/a),g.pdi=D,g.mdi=M;var P=0;M+D!==0&&(P=Math.abs(M-D)/(M+D)*100),c+=P,d>=2*i[0]-2&&(u=d>2*i[0]-2?(u*(i[0]-1)+P)/i[0]:c/i[0],g.adx=u,d>=2*i[0]+i[1]-3&&(g.adxr=((null!==(v=h[d-(i[1]-1)].adx)&&void 0!==v?v:0)+u)/2))}h.push(g)})),h}},ct={name:"EMA",shortName:"EMA",series:U.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=0,r=[];return t.map((function(t,e){var a={},s=t.close;return o+=s,i.forEach((function(t,i){e>=t-1&&(r[i]=e>t-1?(2*s+(t-1)*r[i])/(t+1):o/t,a[n[i].key]=r[i])})),a}))}},ut={name:"MA",shortName:"MA",series:U.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,i){var l;o[i]=(null!==(l=o[i])&&void 0!==l?l:0)+s,r>=e-1&&(a[n[i].key]=o[i]/e,o[i]-=t[r-(e-1)].close)})),a}))}},ht={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s=t.prev,l=t.current,c=null!==(o=null===(n=s.indicatorData)||void 0===n?void 0:n.macd)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=l.indicatorData)||void 0===r?void 0:r.macd)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return{style:c<u?"stroke":"fill",color:u>0?D(e.styles,"bars[0].upColor",i.bars[0].upColor):u<0?D(e.styles,"bars[0].downColor",i.bars[0].downColor):D(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}],calc:function(t,e){var i,n,o=e.calcParams,r=0,a=0,s=0,l=0,c=Math.max(o[0],o[1]);return t.map((function(t,e){var u={},h=t.close;return r+=h,e>=o[0]-1&&(i=e>o[0]-1?(2*h+(o[0]-1)*i)/(o[0]+1):r/o[0]),e>=o[1]-1&&(n=e>o[1]-1?(2*h+(o[1]-1)*n)/(o[1]+1):r/o[1]),e>=c-1&&(a=i-n,u.dif=a,s+=a,e>=c+o[2]-2&&(l=e>c+o[2]-2?(2*a+l*(o[2]-1))/(o[2]+1):s/o[2],u.macd=2*(a-l),u.dea=l)),u}))}},dt={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[],r=[];return t.map((function(e,a){var s,l={},c=(null!==(s=t[a-1])&&void 0!==s?s:e).close,u=e.close-c;return i.forEach((function(e,i){var s,c,h;if(u>0?o[i]=(null!==(s=o[i])&&void 0!==s?s:0)+u:r[i]=(null!==(c=r[i])&&void 0!==c?c:0)+Math.abs(u),a>=e-1){0!==r[i]?l[n[i].key]=100-100/(1+o[i]/r[i]):l[n[i].key]=0;var d=t[a-(e-1)],p=null!==(h=t[a-e])&&void 0!==h?h:d,v=d.close-p.close;v>0?o[i]-=v:r[i]-=Math.abs(v)}})),l}))}},pt={name:"SMA",shortName:"SMA",series:U.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,n=0,o=0;return t.map((function(t,e){var r={},a=t.close;return n+=a,e>=i[0]-1&&(o=e>i[0]-1?(a*i[1]+o*(i[0]-i[1]+1))/(i[0]+1):n/i[0],r.sma=o),r}))}},vt={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[];return t.forEach((function(e,o){var r,a,s,l,c={},u=e.close;if(o>=i[0]-1){var h=H(t.slice(o-(i[0]-1),o+1),"high","low"),d=h[0],p=h[1],v=d-p,g=(u-p)/(0===v?1:v)*100;c.k=((i[1]-1)*(null!==(a=null===(r=n[o-1])||void 0===r?void 0:r.k)&&void 0!==a?a:50)+g)/i[1],c.d=((i[2]-1)*(null!==(l=null===(s=n[o-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50)+c.k)/i[2],c.j=3*c.k-2*c.d}n.push(c)})),n}},gt={name:"SAR",shortName:"SAR",series:U.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t,e,i){var n,o,r=t.current,a=null!==(o=null===(n=r.indicatorData)||void 0===n?void 0:n.sar)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:a<((null==s?void 0:s.high)+(null==s?void 0:s.low))/2?D(e.styles,"circles[0].upColor",i.circles[0].upColor):D(e.styles,"circles[0].downColor",i.circles[0].downColor)}}}],calc:function(t,e){var i=e.calcParams,n=i[0]/100,o=i[1]/100,r=i[2]/100,a=n,s=-100,l=!1,c=0;return t.map((function(e,i){var u=c,h=e.high,d=e.low;if(l){(-100===s||s<h)&&(s=h,a=Math.min(a+o,r)),c=u+a*(s-u);var p=Math.min(t[Math.max(1,i)-1].low,d);c>e.low?(c=s,a=n,s=-100,l=!l):c>p&&(c=p)}else{(-100===s||s>d)&&(s=d,a=Math.min(a+o,r)),c=u+a*(s-u);var v=Math.max(t[Math.max(1,i)-1].high,h);c<e.high?(c=s,a=0,s=-100,l=!l):c<v&&(c=v)}return{sar:c}}))}},ft={name:"VOL",shortName:"VOL",series:U.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?D(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?D(e.styles,"bars[0].downColor",i.bars[0].downColor):D(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}],regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}));return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?D(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?D(e.styles,"bars[0].downColor",i.bars[0].downColor):D(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}),e},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a,s=null!==(a=e.volume)&&void 0!==a?a:0,l={volume:s};return i.forEach((function(e,i){var a,c;o[i]=(null!==(a=o[i])&&void 0!==a?a:0)+s,r>=e-1&&(l[n[i].key]=o[i]/e,o[i]-=null!==(c=t[r-(e-1)].volume)&&void 0!==c?c:0)})),l}))}},mt={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures;return t.map((function(e,o){var r={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(o>=s){var l=H(t.slice(o-s,o+1),"high","low"),c=l[0],u=c-l[1];r[n[i].key]=0===u?0:(a-c)/u*100}})),r}))}},yt={},_t=[et,it,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,l){var c;if(o[l]=(null!==(c=o[l])&&void 0!==c?c:0)+s,r>=e-1){var u=o[l]/i[l];a[n[l].key]=(s-u)/u*100,o[l]-=t[r-(e-1)].close}})),a}))}},nt,{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0;return t.map((function(e,s){var l,c,u={},h=e.high,d=e.low,p=e.open,v=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(r+=h-p,a+=p-d,n+=h-v,o+=v-d,s>=i[0]-1){u.ar=0!==a?r/a*100:0,u.br=0!==o?n/o*100:0;var g=t[s-(i[0]-1)],f=g.high,m=g.low,y=g.open,_=(null!==(c=t[s-i[0]])&&void 0!==c?c:t[s-(i[0]-1)]).close;n-=f-_,o-=_-m,r-=f-y,a-=y-m}return u}))}},ot,rt,at,st,lt,{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,c,u,h={},d=null!==(l=t[s-1])&&void 0!==l?l:e,p=e.high,v=e.low,g=null!==(c=e.turnover)&&void 0!==c?c:0,f=(p+v)/2,m=(d.high+d.low)/2,y=0;0!==g&&(y=(f-m)*(p-v)/g),r.push(y),n+=y,s>=i[0]-1&&(h.emv=n,n-=r[s-(i[0]-1)],o+=h.emv,s>=i[0]+i[1]-2&&(h.maEmv=o/i[1],o-=null!==(u=a[s-(i[1]-1)].emv)&&void 0!==u?u:0)),a.push(h)})),a}},ct,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=[];return t.forEach((function(e,r){var a,s={};if(r>=i[0]){var l=e.close,c=t[r-i[0]].close;s.mtm=l-c,n+=s.mtm,r>=i[0]+i[1]-1&&(s.maMtm=n/i[1],n-=null!==(a=o[r-(i[1]-1)].mtm)&&void 0!==a?a:0)}o.push(s)})),o}},ut,ht,{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[];return t.forEach((function(e,a){var s,l,c,u,h=null!==(s=t[a-1])&&void 0!==s?s:e;e.close<h.close?o-=null!==(l=e.volume)&&void 0!==l?l:0:e.close>h.close&&(o+=null!==(c=e.volume)&&void 0!==c?c:0);var d={obv:o};n+=o,a>=i[0]-1&&(d.maObv=n/i[0],n-=null!==(u=r[a-(i[0]-1)].obv)&&void 0!==u?u:0),r.push(d)})),r}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,n){var o,r,a={},s=i.close,l=null!==(o=i.volume)&&void 0!==o?o:1,c=(null!==(r=t[n-1])&&void 0!==r?r:i).close,u=0,h=c*l;return 0!==h&&(u=(s-c)/h),e+=u,a.pvt=e,a}))}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,c,u={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=e.close-h>0?1:0;r.push(d),n+=d,s>=i[0]-1&&(u.psy=n/i[0]*100,o+=u.psy,s>=i[0]+i[1]-2&&(u.maPsy=o/i[1],o-=null!==(c=a[s-(i[1]-1)].psy)&&void 0!==c?c:0),n-=r[s-(i[0]-1)]),a.push(u)})),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[],o=0;return t.forEach((function(e,r){var a,s,l={};if(r>=i[0]-1){var c=e.close,u=(null!==(a=t[r-i[0]])&&void 0!==a?a:t[r-(i[0]-1)]).close;l.roc=0!==u?(c-u)/u*100:0,o+=l.roc,r>=i[0]-1+i[1]-1&&(l.maRoc=o/i[1],o-=null!==(s=n[r-(i[1]-1)].roc)&&void 0!==s?s:0)}n.push(l)})),n}},dt,pt,vt,gt,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i,n,o,r=e.calcParams,a=0,s=0,l=0,c=0,u=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(a+=p,e>=r[0]-1&&(i=e>r[0]-1?(2*p+(r[0]-1)*i)/(r[0]+1):a/r[0],s+=i,e>=2*r[0]-2&&(n=e>2*r[0]-2?(2*i+(r[0]-1)*n)/(r[0]+1):s/r[0],l+=n,e>=3*r[0]-3))){var v=void 0,g=0;e>3*r[0]-3?g=((v=(2*n+(r[0]-1)*o)/(r[0]+1))-o)/o*100:v=l/r[0],o=v,d.trix=g,c+=g,e>=3*r[0]+r[1]-4&&(d.maTrix=c/r[1],c-=null!==(h=u[e-(r[1]-1)].trix)&&void 0!==h?h:0)}u.push(d)})),u}},ft,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var c,u,h,d,p,v={},g=e.close,f=(null!==(c=t[l-1])&&void 0!==c?c:e).close,m=null!==(u=e.volume)&&void 0!==u?u:0;if(g>f?n+=m:g<f?o+=m:r+=m,l>=i[0]-1){var y=r/2;v.vr=o+y===0?0:(n+y)/(o+y)*100,a+=v.vr,l>=i[0]+i[1]-2&&(v.maVr=a/i[1],a-=null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0);var _=t[l-(i[0]-1)],x=null!==(d=t[l-i[0]])&&void 0!==d?d:_,S=_.close,C=null!==(p=_.volume)&&void 0!==p?p:0;S>x.close?n-=C:S<x.close?o-=C:r-=C}s.push(v)})),s}},mt];function xt(t){var e;return null!==(e=yt[t])&&void 0!==e?e:null}_t.forEach((function(t){yt[t.name]=tt.extend(t)}));var St,Ct=function(){function t(t){this._instances=new Map,this._chartStore=t}return t.prototype._overrideInstance=function(t,e){var i=e.shortName,n=e.series,o=e.calcParams,r=e.precision,a=e.figures,s=e.minValue,l=e.maxValue,c=e.shouldOhlc,u=e.shouldFormatBigNumber,h=e.visible,d=e.styles,p=e.extendData,v=e.regenerateFigures,g=e.createTooltipDataSource,f=e.draw,m=e.calc,y=!1;void 0!==i&&t.setShortName(i)&&(y=!0),void 0!==n&&t.setSeries(n)&&(y=!0);var _=!1;return void 0!==o&&t.setCalcParams(o)&&(y=!0,_=!0),void 0!==a&&t.setFigures(a)&&(y=!0,_=!0),void 0!==s&&t.setMinValue(s)&&(y=!0),void 0!==l&&t.setMinValue(l)&&(y=!0),void 0!==r&&t.setPrecision(r)&&(y=!0),void 0!==c&&t.setShouldOhlc(c)&&(y=!0),void 0!==u&&t.setShouldFormatBigNumber(u)&&(y=!0),void 0!==h&&t.setVisible(h)&&(y=!0),void 0!==d&&t.setStyles(d)&&(y=!0),void 0!==p&&t.setExtendData(p)&&(y=!0,_=!0),void 0!==v&&t.setRegenerateFigures(v)&&(y=!0),void 0!==g&&t.setCreateTooltipDataSource(g)&&(y=!0),void 0!==f&&t.setDraw(f)&&(y=!0),void 0!==m&&(t.calc=m,_=!0),[y,_]},t.prototype.addInstance=function(t,e,i){var n;return o(this,void 0,void 0,(function(){var o,a,s,l;return r(this,(function(r){switch(r.label){case 0:return o=t.name,a=this._instances.get(e),null!==(n=null==a?void 0:a.has(o))&&void 0!==n&&n?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,r.sent()];case 2:return void 0===a&&(a=new Map,this._instances.set(e,a)),s=xt(o),l=new s,this._overrideInstance(l,t),i||a.clear(),a.set(o,l),[4,l.calcIndicator(this._chartStore.getDataList())]}}))}))},t.prototype.getInstances=function(t){var e;return null!==(e=this._instances.get(t))&&void 0!==e?e:new Map},t.prototype.removeInstance=function(t,e){var i=!1,n=this._instances.get(t);return void 0!==n&&(void 0!==e?n.has(e)&&(n.delete(e),i=!0):(n.clear(),i=!0),0===n.size&&this._instances.delete(t)),i},t.prototype.hasInstances=function(t){return this._instances.has(t)},t.prototype.calcInstance=function(t,e){var i;return o(this,void 0,void 0,(function(){var n,o,a,s=this;return r(this,(function(r){switch(r.label){case 0:return n=[],void 0!==t?void 0!==e?(o=this._instances.get(e),null!==(i=null==o?void 0:o.has(t))&&void 0!==i&&i&&(a=null==o?void 0:o.get(t),n.push(a.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach((function(e){if(e.has(t)){var i=null==e?void 0:e.get(t);n.push(i.calcIndicator(s._chartStore.getDataList()))}})):this._instances.forEach((function(t){t.forEach((function(t){n.push(t.calcIndicator(s._chartStore.getDataList()))}))})),[4,Promise.all(n)];case 1:return[2,r.sent().includes(!0)]}}))}))},t.prototype.getInstanceByPaneId=function(t,e){var i;if(void 0!==t){var n=this._instances.get(t);return void 0!==e?null!==(i=null==n?void 0:n.get(e))&&void 0!==i?i:null:null!=n?n:null}return this._instances},t.prototype.setSeriesPrecision=function(t){this._instances.forEach((function(e){e.forEach((function(e){e.series===U.Price&&e.setPrecision(t.price,!0),e.series===U.Volume&&e.setPrecision(t.volume,!0)}))}))},t.prototype.override=function(t,e){return o(this,void 0,void 0,(function(){var i,n,o,a,s,l,c=this;return r(this,(function(r){switch(r.label){case 0:return i=t.name,n=new Map,null!==e?void 0!==(o=this._instances.get(e))&&n.set(e,o):n=this._instances,a=!1,s=[],n.forEach((function(e){var n=e.get(i);if(void 0!==n){var o=c._overrideInstance(n,t);o[1]?s.push(n.calcIndicator(c._chartStore.getDataList())):o[0]&&(a=!0)}})),[4,Promise.all(s)];case 1:return l=r.sent(),[2,[a,l.includes(!0)]]}}))}))},t}(),bt=function(){function t(t){this._crosshair={},this._chartStore=t}return t.prototype.set=function(t,e){var i,o,r=this._chartStore.getDataList(),a=null!=t?t:{},s=r[o=void 0!==a.x?(i=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x))<0?0:i>r.length-1?r.length-1:i:i=r.length-1],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(i),c=this._crosshair.x,u=this._crosshair.y,h=this._crosshair.paneId;return this._crosshair=n(n({},a),{realX:l,kLineData:s,realDataIndex:i,dataIndex:o}),c===a.x&&u===a.y&&h===a.paneId||(null!==s&&this._chartStore.getChart().crosshairChange(this._crosshair),null!=e&&e||this._chartStore.getChart().updatePane(1)),this},t.prototype.recalculate=function(t){this.set(this._crosshair,t)},t.prototype.get=function(){return this._crosshair},t}(),wt=function(){function t(){this._activeIconInfo=null}return t.prototype.setActiveIconInfo=function(t){this._activeIconInfo=null!=t?t:null},t.prototype.getActiveIconInfo=function(){return this._activeIconInfo},t}();!function(t){t.Normal="normal",t.WeakMagnet="weak_magnet",t.StrongMagnet="strong_magnet"}(St||(St={}));var It=1,Et=function(){function t(t){this.currentStep=It,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,i=t.extendData,n=t.styles,o=t.name,r=t.totalStep,a=t.lock,s=t.visible,l=t.needDefaultPointFigure,c=t.needDefaultXAxisFigure,u=t.needDefaultYAxisFigure,h=t.createPointFigures,d=t.createXAxisFigures,p=t.createYAxisFigures,v=t.performEventPressedMove,g=t.performEventMoveForDrawing,f=t.onDrawStart,m=t.onDrawing,y=t.onDrawEnd,_=t.onClick,x=t.onRightClick,S=t.onPressedMoveStart,C=t.onPressedMoving,b=t.onPressedMoveEnd,w=t.onMouseEnter,I=t.onMouseLeave,E=t.onRemoved,T=t.onSelected,D=t.onDeselected;this.name=o,this.totalStep=void 0===r||r<2?1:r,this.lock=null!=a&&a,this.visible=null==s||s,this.needDefaultPointFigure=null!=l&&l,this.needDefaultXAxisFigure=null!=c&&c,this.needDefaultYAxisFigure=null!=u&&u,this.mode=null!=e?e:St.Normal,this.extendData=i,this.styles=null!=n?n:null,this.createPointFigures=null!=h?h:null,this.createXAxisFigures=null!=d?d:null,this.createYAxisFigures=null!=p?p:null,this.performEventPressedMove=null!=v?v:null,this.performEventMoveForDrawing=null!=g?g:null,this.onDrawStart=null!=f?f:null,this.onDrawing=null!=m?m:null,this.onDrawEnd=null!=y?y:null,this.onClick=null!=_?_:null,this.onRightClick=null!=x?x:null,this.onPressedMoveStart=null!=S?S:null,this.onPressedMoving=null!=C?C:null,this.onPressedMoveEnd=null!=b?b:null,this.onMouseEnter=null!=w?w:null,this.onMouseLeave=null!=I?I:null,this.onRemoved=null!=E?E:null,this.onSelected=null!=T?T:null,this.onDeselected=null!=D?D:null}return t.prototype.setId=function(t){return void 0===this.id&&(this.id=t,!0)},t.prototype.setGroupId=function(t){return void 0===this.groupId&&(this.groupId=t,!0)},t.prototype.setExtendData=function(t){return t!==this.extendData&&(this.extendData=t,!0)},t.prototype.setStyles=function(t){return t!==this.styles&&(this.styles=t,!0)},t.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=l([],s(t),!1),t.length>=this.totalStep-1?(this.currentStep=-1,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),null!==this.performEventMoveForDrawing)for(var i=0;i<e;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return-1===this.currentStep&&null!==this.performEventPressedMove&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},t.prototype.setLock=function(t){return this.lock!==t&&(this.lock=t,!0)},t.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},t.prototype.setMode=function(t){return t!==this.mode&&(this.mode=t,!0)},t.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t&&(this.onDrawStart=t,!0)},t.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t&&(this.onDrawing=t,!0)},t.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t&&(this.onDrawEnd=t,!0)},t.prototype.setOnClickCallback=function(t){return this.onClick!==t&&(this.onClick=t,!0)},t.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t&&(this.onRightClick=t,!0)},t.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t&&(this.onPressedMoveStart=t,!0)},t.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t&&(this.onPressedMoving=t,!0)},t.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t&&(this.onPressedMoveEnd=t,!0)},t.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t&&(this.onMouseEnter=t,!0)},t.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t&&(this.onMouseLeave=t,!0)},t.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t&&(this.onRemoved=t,!0)},t.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t&&(this.onSelected=t,!0)},t.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t&&(this.onDeselected=t,!0)},t.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},t.prototype.isDrawing=function(){return-1!==this.currentStep},t.prototype.isStart=function(){return this.currentStep===It},t.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};void 0!==t.timestamp&&(n.timestamp=t.timestamp),void 0!==t.dataIndex&&(n.dataIndex=t.dataIndex),void 0!==t.value&&(n.value=t.value),this.points[i]=n,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},t.prototype.eventPressedPointMove=function(t,e){var i;void 0!==t.dataIndex&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),void 0!==t.value&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},t.prototype.startPressedMove=function(t){this._prevPressedPoint=n({},t),this._prevPressedPoints=u(this.points)},t.prototype.eventPressedOtherMove=function(t,e){var i,o;null!==this._prevPressedPoint&&(void 0!==t.dataIndex&&void 0!==this._prevPressedPoint.dataIndex&&(i=t.dataIndex-this._prevPressedPoint.dataIndex),void 0!==t.value&&void 0!==this._prevPressedPoint.value&&(o=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map((function(t){var r;void 0===t.dataIndex&&void 0!==t.timestamp&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var a=n({},t);return void 0!==i&&void 0!==t.dataIndex&&(a.dataIndex=t.dataIndex+i,a.timestamp=null!==(r=e.dataIndexToTimestamp(a.dataIndex))&&void 0!==r?r:void 0),void 0!==o&&void 0!==t.value&&(a.value=t.value+o),a})))},t.extend=function(e){return function(t){function n(){return t.call(this,e)||this}return i(n,t),n}(t)},t}();function Tt(t,e){return Math.sqrt(Math.pow(t.x+e.x,2)+Math.pow(t.y+e.y,2))}function Dt(t){var e=Tt(t[0],t[1]),i=e+Tt(t[1],t[2]),n=[t[2].x-t[0].x,t[2].y-t[0].y];return[{x:t[1].x-.5*n[0]*e/i,y:t[1].y-.5*n[1]*e/i},{x:t[1].x+.5*n[0]*e/i,y:t[1].y+.5*n[1]*e/i}]}function Mt(t,e){var i=!1,n=e.coordinates;if(n.length>1)for(var o=1;o<n.length;o++){var r=n[o-1],a=n[o];if(r.x===a.x)i=Math.abs(t.x-r.x)<2;else{var s=At(r,a),l=Pt(s,t),c=Math.abs(l-t.y);i=c*c/(s[0]*s[0]+1)<4}if(i)return i}return i}function Pt(t,e){return null!=t?e.x*t[0]+t[1]:e.y}function kt(t,e,i){return Pt(At(t,e),i)}function At(t,e){var i=t.x-e.x;if(0!==i){var n=(t.y-e.y)/i;return[n,t.y-n*t.x]}return null}function Ft(t,e,i){var n=e.coordinates,o=n.length;if(o>1){var r=i.style,a=void 0===r?m.Solid:r,s=i.smooth,l=i.size,c=void 0===l?1:l,u=i.color,h=void 0===u?"currentColor":u,d=i.dashedValue,p=void 0===d?[2,2]:d;if(t.lineWidth=c,t.strokeStyle=h,a===m.Dashed?t.setLineDash(p):t.setLineDash([]),t.beginPath(),t.moveTo(n[0].x,n[0].y),null!=s&&s){for(var v=[],g=1;g<o-1;g++)v=v.concat(Dt([n[g-1],n[g],n[g+1]]));t.quadraticCurveTo(v[0].x,v[0].y,n[1].x,n[1].y);for(var f=2;f<o-1;f++)t.bezierCurveTo(v[2*(f-2)+1].x,v[2*(f-2)+1].y,v[2*(f-1)].x,v[2*(f-1)].y,n[f].x,n[f].y);t.quadraticCurveTo(v[2*(f-2)+1].x,v[2*(f-2)+1].y,n[f].x,n[f].y)}else for(f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y);t.stroke(),t.closePath()}}var Lt={name:"line",checkEventOn:Mt,draw:function(t,e,i){Ft(t,e,i)}};function Rt(t,e,i){var n=null!=i?i:0,o=[];if(t.length>1)if(t[0].x===t[1].x){var r=e.height;if(o.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:r}]}),t.length>2){o.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:r}]});for(var a=t[0].x-t[2].x,s=0;s<n;s++){var l=a*(s+1);o.push({coordinates:[{x:t[0].x+l,y:0},{x:t[0].x+l,y:r}]})}}}else{var c=e.width,u=At(t[0],t[1]),h=u[0],d=u[1];if(o.push({coordinates:[{x:0,y:0*h+d},{x:c,y:c*h+d}]}),t.length>2){var p=t[2].y-h*t[2].x;for(o.push({coordinates:[{x:0,y:0*h+p},{x:c,y:c*h+p}]}),a=d-p,s=0;s<n;s++){var v=d+a*(s+1);o.push({coordinates:[{x:0,y:0*h+v},{x:c,y:c*h+v}]})}}}return o}function Bt(t,e){if(t.length>1){var i=void 0;return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[0].y<t[1].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:kt(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:kt(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}}return[]}var Nt={name:"simpleAnnotation",createPointFigures:function(t){var e,i,n=t.overlay,o=t.coordinates;g(n.extendData)&&(i=d(n.extendData)?n.extendData(n):null!==(e=n.extendData)&&void 0!==e?e:"");var r=o[0].x,a=o[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:r,y:a},{x:r,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:s},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"rectText",attrs:{x:r,y:l,text:null!=i?i:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Ot={name:"simpleTag",createPointFigures:function(t){var e=t.bounding,i=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:i[0].y},{x:e.width,y:i[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,n,o,r,a=t.overlay,s=t.coordinates,l=t.bounding,c=t.yAxis,u=t.precision;return null!==(e=null==c?void 0:c.isFromZero())&&void 0!==e&&e?(n="left",o=0):(n="right",o=l.width),g(a.extendData)&&(r=d(a.extendData)?a.extendData(a):null!==(i=a.extendData)&&void 0!==i?i:""),g(r)||void 0===a.points[0].value||(r=P(a.points[0].value,u.price)),{type:"rectText",attrs:{x:o,y:s[0].y,text:null!=r?r:"",align:n,baseline:"middle"}}}},Vt={};function Wt(t){var e;return null!==(e=Vt[t])&&void 0!==e?e:null}function zt(t){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return void 0!==t&&c(e,t),e}[{name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.overlay,o=t.precision,r=n.points;if(e.length>0){var a=[],s=[],l=i.width;if(e.length>1&&void 0!==r[0].value&&void 0!==r[1].value){var c=e[0].y-e[1].y,u=r[0].value-r[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var i,n=e[1].y+c*t,h=((null!==(i=r[1].value)&&void 0!==i?i:0)+u*t).toFixed(o.price);a.push({coordinates:[{x:0,y:n},{x:l,y:n}]}),s.push({x:0,y:n,text:"".concat(h," (").concat((100*t).toFixed(1),"%)"),baseline:"bottom"})}))}return[{type:"line",attrs:a},{type:"text",isCheckEvent:!1,attrs:s}]}return[]}},{name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n={x:0,y:e[0].y};return void 0!==e[1]&&e[0].x<e[1].x&&(n.x=i.width),[{type:"line",attrs:{coordinates:[e[0],n]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Rt(t.coordinates,t.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Rt(t.coordinates,t.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.precision,o=t.overlay.points[0].value,r=void 0===o?0:o;return[{type:"line",attrs:{coordinates:[e[0],{x:i.width,y:e[0].y}]}},{type:"text",isCheck:!1,attrs:{x:e[0].x,y:e[0].y,text:r.toFixed(n.price),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Bt(t.coordinates,t.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:kt(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:kt(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;if(2===e.length){var n={x:e[0].x,y:0};return e[0].y<e[1].y&&(n.y=i.height),[{type:"line",attrs:{coordinates:[e[0],n]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]}},Nt,Ot].forEach((function(t){Vt[t.name]=Et.extend(t)}));var Yt=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return!(void 0===n||!this.checkEventOn(e))&&n(e,i)},t.prototype.checkEventOn=function(t){var e,i;try{for(var n=a(this._children),o=n.next();!o.done;o=n.next())if(o.value.checkEventOn(t))return!0}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1)for(var o=n;o>-1;o--)if(this._children[o].dispatchEvent(t,e,i))return!0;return this.onEvent(t,e,i)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),Xt="main",Ht="xAxis",jt="yAxis",Gt="separator",Ut=function(t){function e(e,i){var n=t.call(this)||this;return n._bounding=zt(),n._pane=i,n._init(e),n}return i(e,t),e.prototype._init=function(t){if(this._container=O("div",this.getContainerStyle()),this.insertBefore()){var e=t.lastChild;null!==e?t.insertBefore(this._container,e):t.appendChild(this._container)}else t.appendChild(this._container);this.initDom(this._container)},e.prototype.setBounding=function(t){return c(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(t,this._container,this._bounding)},e.prototype.insertBefore=function(){return!1},e}(Yt),Zt=function(t){function e(e,i){var n,o,r,a=t.call(this,e,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._currentPaneHeight=0,a._pressedMouseMoveEvent=(n=a._pressedTouchMouseMoveEvent,o=20,r=0,function(){var t=Date.now();t-r>(null!=o?o:20)&&(n.apply(this,arguments),r=t)}),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return i(e,t),e.prototype.getName=function(){return Gt},e.prototype.checkEventOn=function(){return!0},e.prototype._mouseDownEvent=function(t){var e,i;this._dragFlag=!0,this._dragStartY=t.pageY;var n=this.getPane();return this._topPaneHeight=null!==(i=null===(e=n.getTopPane())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,this._currentPaneHeight=n.getBounding().height,!0},e.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},e.prototype._pressedTouchMouseMoveEvent=function(t){var e=t.pageY-this._dragStartY,i=this.getPane(),n=i.getTopPane(),o=e<0;if(null!==n&&i.getOptions().dragEnabled){var r=void 0,a=void 0,s=void 0,l=void 0;o?(r=n,a=i,s=this._topPaneHeight,l=this._currentPaneHeight):(r=i,a=n,s=this._currentPaneHeight,l=this._topPaneHeight);var c=r.getOptions().minHeight;if(s>c){var u=Math.max(s-Math.abs(e),c),h=s-u;r.setBounding({height:u}),a.setBounding({height:l+h});var d=i.getChart();d.getChartStore().getActionStore().execute(A.OnPaneDrag,{paneId:i.getId}),d.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},e.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getOptions().dragEnabled){var e=t.getChart().getStyles().separator;return this._moveDom.style.background=e.activeBackgroundColor,!0}return!1},e.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this._moveDom.style.background="",!0)},e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}},e.prototype.insertBefore=function(){return!0},e.prototype.initDom=function(t){this._moveDom=O("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"}),t.appendChild(this._moveDom)},e.prototype.updateImp=function(t,e,i){if(4===t||2===t){var n=this.getPane().getChart().getStyles().separator;this._moveDom.style.top="".concat(-Math.floor((7-n.size)/2),"px"),this._moveDom.style.height="".concat(7,"px");var o=n.fill;e.style.backgroundColor=n.color,e.style.height="".concat(n.size,"px"),e.style.marginLeft="".concat(o?0:i.left,"px"),e.style.width=o?"100%":"".concat(i.width,"px")}},e.prototype.getImage=function(){var t=this.getPane().getChart().getStyles().separator,e=this.getContainer().offsetWidth,i=t.size,n=O("canvas",{width:"".concat(e,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),o=n.getContext("2d"),r=V(n);return n.width=e*r,n.height=i*r,o.scale(r,r),o.fillStyle=t.color,o.fillRect(this.getBounding().left,0,e,i),n},e}(Ut),qt=30,Kt={CANDLE:"candle_pane",INDICATOR:"indcator_pane_",XAXIS:"xaxis_pane"},Jt=function(){function t(t,e,i,n,o){this._yAxisWidget=null,this._separatorWidget=null,this._axis=this.createAxisComponent(),this._bounding=zt(),this._options={minHeight:qt,dragEnabled:!0,gap:{top:.2,bottom:.1}},this._chart=e,this._id=i,this._topPane=null!=n?n:null,this._bottomPane=null!=o?o:null,this._init(t)}return t.prototype._init=function(t){this._container=t,this._seriesContiainer=O("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),this._separatorWidget=this.createSeparatorWidget(t);var e=t.lastChild;null!==e?t.insertBefore(this._seriesContiainer,e):t.appendChild(this._seriesContiainer),this._mainWidget=this.createMainWidget(this._seriesContiainer),this._yAxisWidget=this.creatYAxisWidget(this._seriesContiainer)},t.prototype.getContainer=function(){return this._seriesContiainer},t.prototype.getId=function(){return this._id},t.prototype.setOptions=function(t){return c(this._options,t),this},t.prototype.getOptions=function(){return this._options},t.prototype.getChart=function(){return this._chart},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(t,e,i){var o,r,a;c(this._bounding,t);var s=0;if(null!==this._separatorWidget){s=this._chart.getStyles().separator.size;var l=n(n({},t),{height:7});void 0!==t.top&&(l.top=t.top-Math.floor((7-s)/2)),this._separatorWidget.setBounding(l)}var u={};return void 0!==t.height&&(u.height=t.height-s),void 0!==t.top&&(u.top=t.top+s),this._mainWidget.setBounding(u),null===(o=this._yAxisWidget)||void 0===o||o.setBounding(u),void 0!==e&&(this._mainWidget.setBounding(e),null===(r=this._separatorWidget)||void 0===r||r.setBounding(e)),void 0!==i&&(null===(a=this._yAxisWidget)||void 0===a||a.setBounding(i)),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(t){return this._topPane=t,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(t){return this._bottomPane=t,this},t.prototype.getBounding=function(){return this._bounding},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.getSeparatorWidget=function(){return this._separatorWidget},t.prototype.update=function(t){var e,i;this._bounding.width!==this._seriesContiainer.offsetWidth&&(this._seriesContiainer.style.width="".concat(this._bounding.width,"px"));var n=this._mainWidget.getBounding().height;n!==this._seriesContiainer.offsetHeight&&(this._seriesContiainer.style.height="".concat(n,"px"));var o=null!=t?t:3;this._mainWidget.update(o),null===(e=this._yAxisWidget)||void 0===e||e.update(o),null===(i=this._separatorWidget)||void 0===i||i.update(o)},t.prototype.getImage=function(t){var e=this._bounding,i=e.width,n=e.height,o=O("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=V(o);o.width=i*a,o.height=n*a,r.scale(a,a);var s=0;if(null!=this._separatorWidget){var l=this.getChart().getStyles().separator.size;s=l,r.drawImage(this._separatorWidget.getImage(),0,0,i,l)}var c=this._mainWidget.getBounding();if(r.drawImage(this._mainWidget.getImage(t),c.left,s,c.width,c.height),null!==this._yAxisWidget){var u=this._yAxisWidget.getBounding();r.drawImage(this._yAxisWidget.getImage(t),u.left,s,u.width,u.height)}return o},t.prototype.destroy=function(){this._container.removeChild(this._seriesContiainer),null!==this._separatorWidget&&this._container.removeChild(this._separatorWidget.getContainer())},t.prototype.createSeparatorWidget=function(t){return null},t.prototype.creatYAxisWidget=function(t){return null},t}(),$t=function(){function t(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._chartStore=t}return t.prototype._overrideInstance=function(t,e){var i=e.id,n=e.groupId,o=e.points,r=e.styles,a=e.lock,s=e.visible,l=e.mode,c=e.extendData,u=e.onDrawStart,h=e.onDrawing,d=e.onDrawEnd,p=e.onClick,v=e.onRightClick,g=e.onPressedMoveStart,f=e.onPressedMoving,m=e.onPressedMoveEnd,y=e.onMouseEnter,_=e.onMouseLeave,x=e.onRemoved,S=e.onSelected,C=e.onDeselected,b=!1;return void 0!==i&&t.setId(i),void 0!==n&&t.setGroupId(n),void 0!==o&&t.setPoints(o)&&(b=!0),void 0!==r&&t.setStyles(r)&&(b=!0),void 0!==a&&t.setLock(a),void 0!==s&&t.setVisible(s)&&(b=!0),void 0!==l&&t.setMode(l),void 0!==c&&t.setExtendData(c)&&(b=!0),void 0!==u&&t.setOnDrawStartCallback(u),void 0!==h&&t.setOnDrawingCallback(h),void 0!==d&&t.setOnDrawEndCallback(d),void 0!==p&&t.setOnClickCallback(p),void 0!==v&&t.setOnRightClickCallback(v),void 0!==g&&t.setOnPressedMoveStartCallback(g),void 0!==f&&t.setOnPressedMovingCallback(f),void 0!==m&&t.setOnPressedMoveEndCallback(m),void 0!==y&&t.setOnMouseEnterCallback(y),void 0!==_&&t.setOnMouseLeaveCallback(_),void 0!==x&&t.setOnRemovedCallback(x),void 0!==S&&t.setOnSelectedCallback(S),void 0!==C&&t.setOnDeselectedCallback(C),b},t.prototype.getInstanceById=function(t){var e,i;try{for(var n=a(this._instances),o=n.next();!o.done;o=n.next()){var r=o.value[1].find((function(e){return e.id===t}));if(void 0!==r)return r}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return null!==this._progressInstanceInfo&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},t.prototype.addInstance=function(t,e,i){var n,o,r,a,s=null!==(n=t.id)&&void 0!==n?n:N("overlay_");if(null===this.getInstanceById(s)){var l=new(Wt(t.name)),c=null!==(o=t.groupId)&&void 0!==o?o:s;return t.id=s,t.groupId=c,this._overrideInstance(l,t),l.isDrawing()?this._progressInstanceInfo={paneId:e,instance:l,appointPaneFlag:i}:(this._instances.has(e)||this._instances.set(e,[]),null===(r=this._instances.get(e))||void 0===r||r.push(l)),null===(a=l.onDrawStart)||void 0===a||a.call(l,{overlay:l}),this._chartStore.getChart().updatePane(1,e),s}return null},t.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},t.prototype.progressInstanceComplete=function(){var t;if(null!==this._progressInstanceInfo){var e=this._progressInstanceInfo,i=e.instance,n=e.paneId;i.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),null===(t=this._instances.get(n))||void 0===t||t.push(i),this._progressInstanceInfo=null)}},t.prototype.updateProgressInstanceInfo=function(t,e){null!==this._progressInstanceInfo&&(void 0!==e&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t)},t.prototype.getInstances=function(t){var e;if(void 0===t){var i=[];return this._instances.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._instances.get(t))&&void 0!==e?e:[]},t.prototype.override=function(t){var e=this,i=t.id,n=t.groupId,o=t.name,r=!1;if(void 0!==i){var a=this.getInstanceById(i);null!==a&&this._overrideInstance(a,t)&&(r=!0)}else if(this._instances.forEach((function(i){i.forEach((function(i){(void 0!==o&&i.name===o||void 0!==n&&i.groupId===n||void 0===o&&void 0===n)&&e._overrideInstance(i,t)&&(r=!0)}))})),null!==this._progressInstanceInfo){var s=this._progressInstanceInfo.instance;(void 0!==o&&s.name===o||void 0!==n&&s.groupId===n||void 0===o&&void 0===n)&&this._overrideInstance(s,t)&&(r=!0)}r&&this._chartStore.getChart().updatePane(1)},t.prototype.removeInstance=function(t){var e,i,n,o=function(t,e){if(void 0!==t.id){if(e.id!==t.id)return!1}else if(void 0!==t.groupId){if(e.groupId!==t.groupId)return!1}else if(void 0!==t.name&&e.name!==t.name)return!1;return!0},r=[];if(null!==this._progressInstanceInfo){var s=this._progressInstanceInfo.instance;(void 0===t||void 0!==t&&o(t,s))&&(r.push(this._progressInstanceInfo.paneId),null===(n=s.onRemoved)||void 0===n||n.call(s,{overlay:s}),this._progressInstanceInfo=null)}if(void 0!==t){var l=new Map,c=function(e){var i=e[1].filter((function(i){var n;return!o(t,i)||(r.includes(e[0])||r.push(e[0]),null===(n=i.onRemoved)||void 0===n||n.call(i,{overlay:i}),!1)}));i.length>0&&l.set(e[0],i)};try{for(var u=a(this._instances),h=u.next();!h.done;h=u.next())c(h.value)}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}this._instances=l}else this._instances.forEach((function(t,e){r.push(e),t.forEach((function(t){var e;null===(e=t.onRemoved)||void 0===e||e.call(t,{overlay:t})}))})),this._instances.clear();if(r.length>0){var d=this._chartStore.getChart();r.forEach((function(t){d.updatePane(1,t)})),d.updatePane(1,Kt.XAXIS)}},t.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},t.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},t.prototype.setHoverInstanceInfo=function(t,e){var i,o,r,a,s,l=this._hoverInstanceInfo,c=l.instance,u=l.figureType,h=l.figureIndex;(null==c?void 0:c.id)===(null===(i=t.instance)||void 0===i?void 0:i.id)&&u===t.figureType&&h===t.figureIndex||(this._hoverInstanceInfo=t,(null==c?void 0:c.id)!==(null===(o=t.instance)||void 0===o?void 0:o.id)&&(null===(r=null==c?void 0:c.onMouseLeave)||void 0===r||r.call(c,n({overlay:c},e)),null===(s=null===(a=t.instance)||void 0===a?void 0:a.onMouseEnter)||void 0===s||s.call(a,n({overlay:t.instance},e))))},t.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},t.prototype.setClickInstanceInfo=function(t,e){var i,o,r,a,s,l,c,u,h,d=this._clickInstanceInfo,p=d.paneId,v=d.instance,g=d.figureType,f=d.figureIndex;if(null!==(o=null===(i=t.instance)||void 0===i?void 0:i.isDrawing())&&void 0!==o&&o||null===(a=null===(r=t.instance)||void 0===r?void 0:r.onClick)||void 0===a||a.call(r,n({overlay:t.instance},e)),((null==v?void 0:v.id)!==(null===(s=t.instance)||void 0===s?void 0:s.id)||g!==t.figureType||f!==t.figureIndex)&&(this._clickInstanceInfo=t,(null==v?void 0:v.id)!==(null===(l=t.instance)||void 0===l?void 0:l.id))){null===(c=null==v?void 0:v.onDeselected)||void 0===c||c.call(v,n({overlay:v},e)),null===(h=null===(u=t.instance)||void 0===u?void 0:u.onSelected)||void 0===h||h.call(u,n({overlay:t.instance},e));var m=this._chartStore.getChart();m.updatePane(1,t.paneId),p!==t.paneId&&m.updatePane(1,p),m.updatePane(1,Kt.XAXIS)}},t.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},t.prototype.isEmpty=function(){return 0===this._instances.size&&null===this._progressInstanceInfo},t.prototype.isDrawing=function(){var t,e;return null!==this._progressInstanceInfo&&null!==(e=null===(t=this._progressInstanceInfo)||void 0===t?void 0:t.instance.isDrawing())&&void 0!==e&&e},t}(),Qt=function(){function t(){this._actions=new Map}return t.prototype.execute=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},t.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new R),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},t.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);void 0!==i&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},t.prototype.has=function(t){var e=this._actions.get(t);return void 0!==e&&!e.isEmpty()},t}(),te={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function ee(t){var e;return null!==(e=te[t])&&void 0!==e?e:null}var ie=function(){function t(t,e){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:m.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:m.Dashed,dashedValue:[2,2]}},candle:{type:C.CandleSolid,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:m.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:y.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderStyle:m.Solid,borderSize:1,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:_.Always,showType:x.Standard,custom:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},bars:[{style:y.Fill,borderStyle:m.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lines:[{style:m.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:m.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#9D65C9"},{style:m.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:m.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:m.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:y.Fill,borderStyle:m.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:y.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:m.Solid,borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:_.Always,showType:x.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:w.Normal,position:b.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:m.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:y.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:m.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:m.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:y.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:m.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:m.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:y.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:m.Solid,borderDashedValue:[2,2]},polygon:{style:y.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:m.Solid,borderDashedValue:[2,2]},circle:{style:y.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:m.Solid,borderDashedValue:[2,2]},arc:{style:m.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{color:"#1677FF",size:12,family:"Helvetica Neue",weight:"normal"},rectText:{style:y.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:m.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:M,formatBigNumber:k},this._locale=F,this._precision={price:2,volume:0},this._dataList=[],this._timeScaleStore=new $(this),this._indicatorStore=new Ct(this),this._overlayStore=new $t(this),this._crosshairStore=new bt(this),this._tooltipStore=new wt,this._actionStore=new Qt,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return t.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.from,i=t.to,n=e;n<i;n++){var o=this._dataList[n],r=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:r,data:o})}},t.prototype.setOptions=function(t){if(void 0!==t){var e=t.locale,i=t.timezone,n=t.styles,o=t.customApi;void 0!==e&&(this._locale=e),void 0!==i&&this._timeScaleStore.setTimezone(i),void 0!==n&&(f(n)?c(this._styles,ee(n)):c(this._styles,n)),void 0!==o&&c(this._customApi,o)}return this},t.prototype.getStyles=function(){return this._styles},t.prototype.getLocale=function(){return this._locale},t.prototype.getCustomApi=function(){return this._customApi},t.prototype.getPrecision=function(){return this._precision},t.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},t.prototype.getDataList=function(){return this._dataList},t.prototype.getVisibleDataList=function(){return this._visibleDataList},t.prototype.addData=function(t,e,i){if(h(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(null==i||i);var n=0===this._dataList.length;this._dataList=t.concat(this._dataList),n&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else if(e>=this._dataList.length){this._dataList.push(t);var o=this._timeScaleStore.getOffsetRightBarCount();o<0&&this._timeScaleStore.setOffsetRightBarCount(--o),this._timeScaleStore.adjustVisibleRange()}else this._dataList[e]=t,this.adjustVisibleDataList();this._crosshairStore.recalculate(!0)},t.prototype.clearDataList=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()},t.prototype.getTimeScaleStore=function(){return this._timeScaleStore},t.prototype.getIndicatorStore=function(){return this._indicatorStore},t.prototype.getOverlayStore=function(){return this._overlayStore},t.prototype.getCrosshairStore=function(){return this._crosshairStore},t.prototype.getTooltipStore=function(){return this._tooltipStore},t.prototype.getActionStore=function(){return this._actionStore},t.prototype.getChart=function(){return this._chart},t}();function ne(t){return null==window.requestAnimationFrame?window.setTimeout(t,20):window.requestAnimationFrame(t)}function oe(t){null==window.cancelAnimationFrame&&window.clearTimeout(t),window.cancelAnimationFrame(t)}var re=-1,ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._mainRequestAnimationId=re,e._overlayRequestAnimationId=re,e}return i(e,t),e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}},e.prototype.initDom=function(t){this._mainCanvas=O("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=O("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d"),t.appendChild(this._mainCanvas),t.appendChild(this._overlayCanvas)},e.prototype._optimalUpdateMain=function(){var t=this;this._mainRequestAnimationId!==re&&(oe(this._mainRequestAnimationId),this._mainRequestAnimationId=re),this._mainRequestAnimationId=ne((function(){t.updateMain(t._mainCtx)}))},e.prototype._optimalUpdateOverlay=function(){var t=this;this._overlayRequestAnimationId!==re&&(oe(this._overlayRequestAnimationId),this._overlayRequestAnimationId=re),this._overlayRequestAnimationId=ne((function(){t.updateOverlay(t._overlayCtx)}))},e.prototype.updateImp=function(t,e,i){var n=i.width,o=i.height,r=i.left;e.style.left="".concat(r,"px");var a=t;if(n!==e.offsetWidth||o!==e.offsetHeight){this._mainCtx.clearRect(0,0,this._mainCanvas.offsetWidth,this._mainCanvas.offsetHeight),this._overlayCtx.clearRect(0,0,this._overlayCanvas.offsetWidth,this._overlayCanvas.offsetHeight);var s="".concat(n,"px"),l="".concat(o,"px");e.style.width=s,e.style.height=l;var c=V(this._mainCanvas),u=Math.floor(n*c),h=Math.floor(o*c);this._mainCanvas.style.width=s,this._mainCanvas.style.height=l,this._mainCanvas.width=u,this._mainCanvas.height=h,this._mainCtx.scale(c,c),this._overlayCanvas.style.width=s,this._overlayCanvas.style.height=l,this._overlayCanvas.width=u,this._overlayCanvas.height=h,this._overlayCtx.scale(c,c),a=3}else 4!==a&&3!==a&&0!==a||this._mainCtx.clearRect(0,0,this._mainCanvas.offsetWidth,this._mainCanvas.offsetHeight),4!==a&&3!==a&&1!==a||this._overlayCtx.clearRect(0,0,this._overlayCanvas.offsetWidth,this._overlayCanvas.offsetHeight);switch(a){case 0:this._optimalUpdateMain();break;case 1:this._optimalUpdateOverlay();break;case 3:case 4:this._optimalUpdateMain(),this._optimalUpdateOverlay()}},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=O("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=V(o);return o.width=i*a,o.height=n*a,r.scale(a,a),r.drawImage(this._mainCanvas,0,0,i,n),t&&r.drawImage(this._overlayCanvas,0,0,i,n),o},e}(Ut),se=2,le=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return i(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.checkEventOnImp=function(e,i,n){return t.checkEventOn(e,i,n)},n.prototype.drawImp=function(e,i,n){t.draw(e,i,n)},n}(e);return n},e}(Yt);function ce(t,e){var i=t.x-e.x,n=t.y-e.y,o=e.r;return!(i*i+n*n>o*o)}function ue(t,e,i){var n=e.x,o=e.y,r=e.r,a=i.style,s=void 0===a?y.Fill:a,l=i.color,c=void 0===l?"currentColor":l,u=i.borderSize,h=void 0===u?1:u,d=i.borderColor,p=void 0===d?"currentColor":d,v=i.borderStyle,g=void 0===v?m.Solid:v,f=i.borderDashedValue,_=void 0===f?[2,2]:f;s!==y.Fill&&i.style!==y.StrokeFill||(t.fillStyle=c,t.beginPath(),t.arc(n,o,r,0,2*Math.PI),t.closePath(),t.fill()),s!==y.Stroke&&i.style!==y.StrokeFill||(t.strokeStyle=p,t.lineWidth=h,g===m.Dashed?t.setLineDash(_):t.setLineDash([]),t.beginPath(),t.arc(n,o,r,0,2*Math.PI),t.closePath(),t.stroke())}var he={name:"circle",checkEventOn:ce,draw:function(t,e,i){ue(t,e,i)}};function de(t,e){for(var i=!1,n=e.coordinates,o=0,r=n.length-1;o<n.length;r=o++)n[o].y>t.y!=n[r].y>t.y&&t.x<(n[r].x-n[o].x)*(t.y-n[o].y)/(n[r].y-n[o].y)+n[o].x&&(i=!i);return i}function pe(t,e,i){var n=e.coordinates,o=i.style,r=void 0===o?y.Fill:o,a=i.color,s=void 0===a?"currentColor":a,l=i.borderSize,c=void 0===l?1:l,u=i.borderColor,h=void 0===u?"currentColor":u,d=i.borderStyle,p=void 0===d?m.Solid:d,v=i.borderDashedValue,g=void 0===v?[2,2]:v;if(r===y.Fill||i.style===y.StrokeFill){t.fillStyle=s,t.beginPath(),t.moveTo(n[0].x,n[0].y);for(var f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y);t.closePath(),t.fill()}if(r===y.Stroke||i.style===y.StrokeFill){for(t.strokeStyle=h,t.lineWidth=c,p===m.Dashed?t.setLineDash(g):t.setLineDash([]),t.beginPath(),t.moveTo(n[0].x,n[0].y),f=1;f<n.length;f++)t.lineTo(n[f].x,n[f].y);t.closePath(),t.stroke()}}var ve={name:"polygon",checkEventOn:de,draw:function(t,e,i){pe(t,e,i)}};function ge(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height}function fe(t,e,i){var n=e.x,o=e.y,r=e.width,a=e.height,s=i.style,l=void 0===s?y.Fill:s,c=i.color,u=void 0===c?"currentColor":c,h=i.borderSize,d=void 0===h?1:h,p=i.borderColor,v=void 0===p?"currentColor":p,g=i.borderStyle,f=void 0===g?m.Solid:g,_=i.borderRadius,x=void 0===_?0:_,S=i.borderDashedValue,C=void 0===S?[2,2]:S;l!==y.Fill&&i.style!==y.StrokeFill||(t.fillStyle=u,t.beginPath(),t.moveTo(n+x,o),t.arcTo(n+r,o,n+r,o+a,x),t.arcTo(n+r,o+a,n,o+a,x),t.arcTo(n,o+a,n,o,x),t.arcTo(n,o,n+r,o,x),t.closePath(),t.fill()),l!==y.Stroke&&i.style!==y.StrokeFill||(t.strokeStyle=v,t.lineWidth=d,f===m.Dashed?t.setLineDash(C):t.setLineDash([]),t.beginPath(),t.moveTo(n+x,o),t.arcTo(n+r,o,n+r,o+a,x),t.arcTo(n+r,o+a,n,o+a,x),t.arcTo(n,o+a,n,o,x),t.arcTo(n,o,n+r,o,x),t.closePath(),t.stroke())}var me={name:"rect",checkEventOn:ge,draw:function(t,e,i){fe(t,e,i)}};function ye(t,e,i){var n=e.size,o=void 0===n?12:n,r=e.paddingLeft,a=void 0===r?0:r,s=e.paddingTop,l=void 0===s?0:s,c=e.paddingRight,u=void 0===c?0:c,h=e.paddingBottom,d=void 0===h?0:h,p=t.x,v=t.y,g=t.text,f=t.align,m=void 0===f?"left":f,y=t.baseline,_=void 0===y?"top":y,x=g.length;i=null!=i?i:o*x;var S,C,b=o;switch(m){case"left":case"start":S=p;break;case"right":case"end":S=p-u-i-a;break;default:S=p-i/2-a}switch(_){case"top":case"hanging":C=v;break;case"bottom":case"ideographic":case"alphabetic":C=v-b-l-d;break;default:C=v-b/2-l}return{x:S,y:C,width:a+i+u,height:l+b+d}}function _e(t,e,i){var n=ye(e,i),o=n.x,r=n.y,a=n.width,s=n.height;return t.x>=o&&t.x<=o+a&&t.y>=r&&t.y<=r+s}function xe(t,e,i){var n=e.x,o=e.y,r=e.text,a=e.align,s=void 0===a?"left":a,l=e.baseline,c=void 0===l?"top":l,u=i.color,h=void 0===u?"currentColor":u,d=i.size,p=void 0===d?12:d,v=i.family,g=i.weight;t.textAlign=s,t.textBaseline=c,t.font=W(p,g,v),t.fillStyle=h,t.fillText(r,n,o)}var Se={name:"text",checkEventOn:function(t,e,i){return _e(t,e,i)},draw:function(t,e,i){xe(t,e,i)}};function Ce(t,e,i){var o=e.text,r=i.size,a=void 0===r?12:r,s=i.family,l=i.weight,c=i.paddingLeft,u=void 0===c?0:c,h=i.paddingTop,d=void 0===h?0:h;t.font=W(a,l,s);var p=ye(e,i,t.measureText(o).width);fe(t,p,n(n({},i),{color:i.backgroundColor})),xe(t,{x:p.x+u,y:p.y+d,text:o,align:"left",baseline:"top"},i)}var be={name:"rectText",checkEventOn:function(t,e,i){return _e(t,e,i)},draw:function(t,e,i){Ce(t,e,i)}},we={};[he,Lt,ve,me,Se,be].forEach((function(t){we[t.name]=le.extend(t)}));var Ie=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return i(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e,i,n){var o=function(t){var e;return null!==(e=we[t])&&void 0!==e?e:null}(t);if(null!==o){var r=new o({name:t,attrs:e,styles:i});if(void 0!==n){for(var a in n)n.hasOwnProperty(a)&&r.registerEvent(a,n[a]);this.addChild(r)}return r}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Yt),Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=this.getWidget().getPane(),r=o.getChart(),a=n.getBounding(),s=r.getStyles().grid;if(s.show){t.save(),t.globalCompositeOperation="destination-over";var l=s.horizontal;l.show&&o.getAxisComponent().getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:0,y:e.coord},{x:a.width,y:e.coord}]},l))||void 0===n||n.draw(t)}));var c=s.vertical;c.show&&(null===(e=r.getPaneById(Kt.XAXIS))||void 0===e?void 0:e.getAxisComponent()).getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:e.coord,y:0},{x:e.coord,y:a.height}]},c))||void 0===n||n.draw(t)})),t.restore()}},e}(Ie),Te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.eachChildren=function(t){var e=this.getWidget().getPane().getChart().getChartStore(),i=e.getVisibleDataList(),n=e.getTimeScaleStore().getBarSpace();i.forEach((function(e,i){t(e,n,i)}))},e}(Ie),De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget().getPane(),n=i.getChart().getChartStore(),o=this.getCandleBarOptions(n);if(null!==o){var r=i.getAxisComponent();this.eachChildren((function(i,n){e._drawCandleBar(t,r,i,n,o)}))}},e.prototype.getCandleBarOptions=function(t){var e=t.getStyles().candle;return{type:e.type,styles:e.bar}},e.prototype._drawCandleBar=function(t,e,i,n,o){var r,a=this,s=i.data,l=i.x,c=s.open,u=s.high,h=s.low,d=s.close,p=n.halfGapBar,v=n.gapBar,g=o.type,f=o.styles;r=d>c?f.upColor:d<c?f.downColor:f.noChangeColor;var m=e.convertToPixel(c),_=e.convertToPixel(d),x=[m,_,e.convertToPixel(u),e.convertToPixel(h)];x.sort((function(t,e){return t-e}));var S=Math.max(1,x[2]-x[1]),b=[];g!==C.Ohlc?(b.push({name:"rect",attrs:{x:l-.5,y:x[0],width:1,height:x[1]-x[0]},styles:{color:r}}),g===C.CandleStroke||g===C.CandleUpStroke&&c<d||g===C.CandleDownStroke&&c>d?b.push({name:"rect",attrs:{x:l-p+.5,y:x[1],width:v-1,height:S},styles:{style:y.Stroke,borderColor:r}}):b.push({name:"rect",attrs:{x:l-p,y:x[1],width:v,height:S},styles:{color:r}}),b.push({name:"rect",attrs:{x:l-.5,y:x[2],width:1,height:x[3]-x[2]},styles:{color:r}})):b=[{name:"rect",attrs:{x:l-.5,y:x[0],width:1,height:x[3]-x[0]},styles:{color:r}},{name:"rect",attrs:{x:l-p,y:m,width:p,height:1},styles:{color:r}},{name:"rect",attrs:{x:l,y:_,width:p,height:1},styles:{color:r}}],b.forEach((function(e){var i,n=e.attrs,o=e.styles;null===(i=a.createFigure("rect",n,o))||void 0===i||i.draw(t)}))},e}(Te),Me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getCandleBarOptions=function(t){var e,i,n=this.getWidget().getPane();if(!n.getAxisComponent().isInCandle()){var o=t.getIndicatorStore().getInstances(n.getId());try{for(var r=a(o),s=r.next();!s.done;s=r.next()){var l=s.value[1];if(l.shouldOhlc&&l.visible){var c=l.styles,u=t.getStyles().indicator;return{type:C.Ohlc,styles:{upColor:D(c,"ohlc.upColor",u.ohlc.upColor),downColor:D(c,"ohlc.downColor",u.ohlc.downColor),noChangeColor:D(c,"ohlc.noChangeColor",u.ohlc.noChangeColor)}}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}}return null},e.prototype.drawImp=function(e){var i,n=this;t.prototype.drawImp.call(this,e);var o=this.getWidget(),r=o.getPane(),a=r.getChart(),s=o.getBounding(),l=null===(i=a.getPaneById(Kt.XAXIS))||void 0===i?void 0:i.getAxisComponent(),c=r.getAxisComponent(),u=a.getChartStore(),h=u.getDataList(),d=u.getTimeScaleStore(),p=d.getVisibleRange(),v=u.getIndicatorStore().getInstances(r.getId()),f=u.getStyles().indicator;v.forEach((function(t){var i;if(t.visible){var o=!1;if(null!==t.draw&&(e.save(),o=null!==(i=t.draw({ctx:e,kLineDataList:h,indicator:t,visibleRange:p,bounding:s,barSpace:d.getBarSpace(),defaultStyles:f,xAxis:l,yAxis:c}))&&void 0!==i&&i,e.restore()),!o){var r=t.result,a=[],u=[],v=[];n.eachChildren((function(i,o){var s,l=o.halfGapBar,d=o.gapBar,m=i.dataIndex,y=i.x,_=null!==(s=r[m])&&void 0!==s?s:{};Q(h,t,m,f,(function(t,i,o,r){var s,h,f,x=_[t.key],S=c.convertToPixel(x);switch(t.type){case"circle":g(x)&&(null===(s=n.createFigure("circle",{x:y,y:S,r:l},{style:i.style,color:i.color,borderColor:i.color}))||void 0===s||s.draw(e));break;case"bar":if(g(x)){var C=null!==(h=t.baseValue)&&void 0!==h?h:c.getExtremum().min,b=c.convertToPixel(C),w=Math.abs(b-S);C!==x&&(w=Math.max(1,w));var I=void 0;I=S>b?b:S,null===(f=n.createFigure("rect",{x:y-l,y:I,width:d,height:w},{style:i.style,color:i.color,borderColor:i.color}))||void 0===f||f.draw(e)}break;case"line":var E=null;if(g(x)){E=i;var T={x:y,y:S},D=a[r];g(u[r])||(u[r]=[]),u[r].push(T),g(D)&&((null==D?void 0:D.color)!==i.color||(null==D?void 0:D.style)!==i.style)&&(v.push({name:"line",attrs:{coordinates:u[r]},styles:{style:i.style,color:i.color,size:o.size,smooth:o.smooth,dashedValue:o.dashedValue}}),u[r]=[T]),m===p.to-1&&v.push({name:"line",attrs:{coordinates:u[r]},styles:{style:i.style,color:null==i?void 0:i.color,size:o.size,smooth:o.smooth,dashedValue:o.dashedValue}})}a[r]=E}}))})),v.forEach((function(t){var i,o=t.attrs,r=t.styles;null===(i=n.createFigure("line",o,r))||void 0===i||i.draw(e)}))}}}))},e}(De),Pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=e.getBounding(),o=e.getPane().getChart().getChartStore(),r=o.getCrosshairStore().get(),a=o.getStyles().crosshair;if(void 0!==r.paneId&&a.show){if(r.paneId===i.getId()){var s=r.y;this._drawLine(t,[{x:0,y:s},{x:n.width,y:s}],a.horizontal)}var l=r.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:n.height}],a.vertical)}},e.prototype._drawLine=function(t,e,i){var n;if(i.show){var o=i.line;o.show&&(null===(n=this.createFigure("line",{coordinates:e},o))||void 0===n||n.draw(t))}},e}(Ie),ke=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._boundIconClickEvent=function(t,i){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(A.OnTooltipIconClick,n(n({},t),{iconId:i})),!0}},e._boundIconMouseMoveEvent=function(t,i){return function(){return e.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIconInfo(n(n({},t),{iconId:i})),!0}},e}return i(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=i.getChart().getChartStore(),o=n.getCrosshairStore().get();if(void 0!==o.kLineData){var r=e.getBounding(),a=n.getCustomApi(),s=n.getIndicatorStore().getInstances(i.getId()),l=n.getTooltipStore().getActiveIconInfo(),c=n.getStyles().indicator;this.drawIndicatorTooltip(t,i.getId(),n.getDataList(),o,l,s,a,r,c)}},e.prototype.drawIndicatorTooltip=function(t,e,i,n,o,r,a,l,c,u){var h=this,d=c.tooltip,p=0;if(this.isDrawTooltip(n,d)){var v=d.text,g=0,f=null!=u?u:0,m=0;r.forEach((function(r){var u=h.getIndicatorTooltipData(i,n,r,a,c),d=u.name,y=u.calcParamsText,_=u.values,x=u.icons,S=d.length>0,C=_.length>0;if(S||C){var b=s(h.classifyTooltipIcons(x),3),w=b[0],I=b[1],E=b[2],T=s(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,w,g,f,m),4),D=T[0],M=T[1],P=T[2],k=T[3];if(g=D,f=M,p+=k,m=P,S){var A=d;y.length>0&&(A="".concat(A).concat(y));var F=s(h.drawStandardTooltipLabels(t,l,[{title:{text:"",color:v.color},value:{text:A,color:v.color}}],g,f,m,v),4),L=F[0],R=F[1],B=F[2],N=F[3];g=L,f=R,p+=N,m=B}var O=s(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,I,g,f,m),4),V=O[0],W=O[1],z=O[2],Y=O[3];if(g=V,f=W,p+=Y,m=z,C){var X=s(h.drawStandardTooltipLabels(t,l,_,g,f,m,v),4),H=X[0],j=X[1],G=X[2],U=X[3];g=H,f=j,p+=U,m=G}var Z=s(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,E,g,f,m),4),q=Z[1],K=Z[2],J=Z[3];g=0,p+=J,f=q+K,m=0}}))}return p},e.prototype.drawStandardTooltipIcons=function(t,e,i,n,o,r,a,s){var l=this,c=r,u=a,h=0,d=0,p=0;return o.length>0&&(o.forEach((function(e){var i=e.marginLeft,n=e.marginTop,o=e.marginRight,r=e.marginBottom,a=e.paddingLeft,s=e.paddingTop,l=e.paddingRight,c=e.paddingBottom,u=e.size,p=e.fontFamily,v=e.icon;t.font=W(u,"normal",p),h+=i+a+t.measureText(v).width+l+o,d=Math.max(d,n+s+u+c+r)})),c+h>e.width?(c=o[0].marginLeft,u+=s,p=d):p=Math.max(0,d-s),o.forEach((function(e){var o,r=e.marginLeft,a=e.marginTop,s=e.marginRight,h=e.paddingLeft,d=e.paddingTop,p=e.paddingRight,v=e.paddingBottom,g=e.color,f=e.activeColor,m=e.size,y=e.fontFamily,_=e.icon,x=e.backgroundColor,S=e.activeBackgroundColor;c+=r;var C=(null==n?void 0:n.paneId)===i.paneId&&(null==n?void 0:n.indicatorName)===i.indicatorName&&(null==n?void 0:n.iconId)===e.id;null===(o=l.createFigure("rectText",{text:_,x:c,y:u+a},{paddingLeft:h,paddingTop:d,paddingRight:p,paddingBottom:v,color:C?f:g,size:m,family:y,backgroundColor:C?S:x},{mouseDownEvent:l._boundIconClickEvent(i,e.id),mouseMoveEvent:l._boundIconMouseMoveEvent(i,e.id)}))||void 0===o||o.draw(t),c+=h+t.measureText(_).width+p+s}))),[c,u,Math.max(s,d),p]},e.prototype.drawStandardTooltipLabels=function(t,e,i,n,o,r,a){var s=this,l=n,c=o,u=0,h=0,d=r;if(i.length>0){var p=a.marginLeft,v=a.marginTop,g=a.marginRight,f=a.marginBottom,m=a.size,y=a.family,_=a.weight;t.font=W(m,_,y),i.forEach((function(i){var n,o,r=i.title,a=i.value,x=t.measureText(r.text).width,S=t.measureText(a.text).width,C=m+v+f;l+p+(x+S)+g>e.width?(l=p,c+=C,h+=C):(l+=p,h+=Math.max(0,C-d)),u=Math.max(d,C),d=u,r.text.length>0&&(null===(n=s.createFigure("text",{x:l,y:c+v,text:r.text},{color:r.color,size:m,family:y,weight:_}))||void 0===n||n.draw(t),l+=x),null===(o=s.createFigure("text",{x:l,y:c+v,text:a.text},{color:a.color,size:m,family:y,weight:_}))||void 0===o||o.draw(t),l+=S+g}))}return[l,c,u,h]},e.prototype.isDrawTooltip=function(t,e){var i=e.showRule;return i===_.Always||i===_.FollowCross&&void 0!==t.paneId},e.prototype.getIndicatorTooltipData=function(t,e,i,n,o){var r,a,s,l=o.tooltip,c=l.showName?i.shortName:"",u="",h=i.calcParams;h.length>0&&l.showParams&&(u="(".concat(h.join(","),")"));var d={name:c,calcParamsText:u,values:[],icons:l.icons},v=e.dataIndex,f=null!==(r=i.result)&&void 0!==r?r:[],m=[];if(i.visible){var y=null!==(a=f[v])&&void 0!==a?a:{};Q(t,i,v,o,(function(t,e){if(void 0!==t.title){var o=e.color,r=y[t.key];g(r)&&(r=P(r,i.precision),i.shouldFormatBigNumber&&(r=n.formatBigNumber(r))),m.push({title:{text:t.title,color:o},value:{text:null!=r?r:l.defaultValue,color:o}})}})),d.values=m}if(null!==i.createTooltipDataSource){var _=this.getWidget(),x=_.getPane(),S=x.getChart().getChartStore(),C=i.createTooltipDataSource({kLineDataList:t,indicator:i,visibleRange:S.getTimeScaleStore().getVisibleRange(),bounding:_.getBounding(),crosshair:e,defaultStyles:o,xAxis:null===(s=x.getChart().getPaneById(Kt.XAXIS))||void 0===s?void 0:s.getAxisComponent(),yAxis:x.getAxisComponent()}),b=C.name,w=C.calcParamsText,I=C.values,E=C.icons;if(void 0!==b&&l.showName&&(d.name=b),void 0!==w&&l.showParams&&(d.calcParamsText=w),void 0!==E&&(d.icons=E),void 0!==I&&i.visible){var T=[],D=o.tooltip.text.color;I.forEach((function(t){var e={text:"",color:D};p(t.title)?e=t.title:e.text=t.title;var i={text:"",color:D};p(t.value)?i=t.value:i.text=t.value,T.push({title:e,value:i})})),d.values=T}}return d},e.prototype.classifyTooltipIcons=function(t){var e=[],i=[],n=[];return t.forEach((function(t){switch(t.position){case S.Left:e.push(t);break;case S.Middle:i.push(t);break;case S.Right:n.push(t)}})),[e,i,n]},e}(Ie),Ae=function(t){function e(e){var i=t.call(this,e)||this;return i._initEvent(),i}return i(e,t),e.prototype._initEvent=function(){var t=this,e=this.getWidget().getPane(),i=e.getId(),o=e.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",(function(e){var r,a=o.getProgressInstanceInfo();if(null!==a){var s=a.instance,l=a.paneId;return s.isStart()&&(o.updateProgressInstanceInfo(i),l=i),s.isDrawing()&&l===i&&(s.eventMoveForDrawing(t._coordinateToPoint(a.instance,e)),null===(r=s.onDrawing)||void 0===r||r.call(s,n({overlay:s},e))),t._figureMouseMoveEvent(a.instance,1,a.instance.points.length-1,0)(e)}return o.setHoverInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseDownEvent",(function(e){var r,a,s=o.getProgressInstanceInfo();if(null!==s){var l=s.instance,c=s.paneId;return l.isStart()&&(o.updateProgressInstanceInfo(i,!0),c=i),l.isDrawing()&&c===i&&(l.eventMoveForDrawing(t._coordinateToPoint(l,e)),null===(r=l.onDrawing)||void 0===r||r.call(l,n({overlay:l},e)),l.nextStep(),l.isDrawing()||(o.progressInstanceComplete(),null===(a=l.onDrawEnd)||void 0===a||a.call(l,n({overlay:l},e)))),t._figureMouseDownEvent(l,1,l.points.length-1,0)(e)}return o.setClickInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseRightClickEvent",(function(e){var i=o.getProgressInstanceInfo();if(null!==i){var n=i.instance;if(n.isDrawing())return t._figureMouseRightClickEvent(n,1,n.points.length-1,0)(e)}return!1})).registerEvent("mouseUpEvent",(function(t){var e,r=o.getPressedInstanceInfo().instance;return null!==r&&(null===(e=r.onPressedMoveEnd)||void 0===e||e.call(r,n({overlay:r},t))),o.setPressedInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,r,a=o.getPressedInstanceInfo(),s=a.instance,l=a.figureType,c=a.figureIndex;if(null!==s){if(!(s.lock||null!==(r=null===(i=s.onPressedMoving)||void 0===i?void 0:i.call(s,n({overlay:s},e)))&&void 0!==r&&r)){var u=t._coordinateToPoint(s,e);1===l?s.eventPressedPointMove(u,c):s.eventPressedOtherMove(u,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1}))},e.prototype._createFigureEvents=function(t,e,i,n){if(!t.isDrawing())return{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,n),mouseDownEvent:this._figureMouseDownEvent(t,e,i,n),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,n)}},e.prototype._figureMouseMoveEvent=function(t,e,i,n){var o=this;return function(r){var a=o.getWidget().getPane();return a.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:a.getId(),instance:t,figureType:e,figureIndex:i,attrsIndex:n},r),!0}},e.prototype._figureMouseDownEvent=function(t,e,i,o){var r=this;return function(a){var s,l=r.getWidget().getPane(),c=l.getId(),u=l.getChart().getChartStore().getOverlayStore();return t.startPressedMove(r._coordinateToPoint(t,a)),null===(s=t.onPressedMoveStart)||void 0===s||s.call(t,n({overlay:t},a)),u.setPressedInstanceInfo({paneId:c,instance:t,figureType:e,figureIndex:i,attrsIndex:o}),u.setClickInstanceInfo({paneId:c,instance:t,figureType:e,figureIndex:i,attrsIndex:o},a),!0}},e.prototype._figureMouseRightClickEvent=function(t,e,i,o){var r=this;return function(e){var i,o;return null!==(o=null===(i=t.onRightClick)||void 0===i?void 0:i.call(t,n({overlay:t},e)))&&void 0!==o&&o||r.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t),!0}},e.prototype._coordinateToPoint=function(t,e){var i,n,o={},r=this.getWidget().getPane(),a=r.getChart(),s=r.getId(),l=a.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var c=(null===(i=a.getPaneById(Kt.XAXIS))||void 0===i?void 0:i.getAxisComponent()).convertFromPixel(e.x),u=null!==(n=l.dataIndexToTimestamp(c))&&void 0!==n?n:void 0;o.dataIndex=c,o.timestamp=u}if(this.coordinateToPointValueFlag()){var h=r.getAxisComponent(),d=h.convertFromPixel(e.y);if(t.mode!==St.Normal&&s===Kt.CANDLE&&void 0!==o.dataIndex){var p=l.getDataByDataIndex(o.dataIndex);if(null!==p)if(d>p.high)if(t.mode===St.WeakMagnet){var v=h.convertToPixel(p.high);d<h.convertFromPixel(v-8)&&(d=p.high)}else d=p.high;else if(d<p.low)if(t.mode===St.WeakMagnet){var g=h.convertToPixel(p.low);d>h.convertFromPixel(g-8)&&(d=p.low)}else d=p.low;else{var f=Math.max(p.open,p.close),m=Math.min(p.open,p.close);d=d>f?d-f<p.high-d?f:p.high:d<m?d-p.low<m-d?p.low:m:f-d<d-m?f:m}}o.value=d}return o},e.prototype.coordinateToPointValueFlag=function(){return!0},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.dispatchEvent=function(e,i,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,i,n):t.prototype.dispatchEvent.call(this,e,i,n)},e.prototype.checkEventOn=function(){return!0},e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart(),s=o.getAxisComponent(),l=null===(e=a.getPaneById(Kt.XAXIS))||void 0===e?void 0:e.getAxisComponent(),c=n.getBounding(),u=a.getChartStore(),h=u.getCustomApi(),d=u.getTimeScaleStore(),p=d.getDateTimeFormat(),v=d.getBarSpace(),g=u.getPrecision(),f=u.getStyles().overlay,m=u.getOverlayStore(),y=m.getHoverInstanceInfo(),_=m.getClickInstanceInfo();this.getCompleteOverlays(m,r).forEach((function(e){e.visible&&i._drawOverlay(t,e,c,v,g,p,h,f,l,s,y,_,d)}));var x=m.getProgressInstanceInfo();if(null!==x){var S=this.getProgressOverlay(x,r);null!==S&&S.visible&&this._drawOverlay(t,S,c,v,g,p,h,f,l,s,y,_,d)}},e.prototype._drawOverlay=function(t,e,i,n,o,r,a,s,l,c,u,h,d){var p=e.points.map((function(t){var e,i,n=t.dataIndex;void 0!==t.timestamp&&(n=d.timestampToDataIndex(t.timestamp));var o={x:0,y:0};return void 0!==n&&(o.x=null!==(e=null==l?void 0:l.convertToPixel(n))&&void 0!==e?e:0),void 0!==t.value&&(o.y=null!==(i=null==c?void 0:c.convertToPixel(t.value))&&void 0!==i?i:0),o}));if(p.length>0){var v=(new Array).concat(this.getFigures(e,p,i,n,o,r,s,l,c));this.drawFigures(t,e,v,s)}this.drawDefaultFigures(t,e,p,i,o,r,a,s,l,c,u,h)},e.prototype.drawFigures=function(t,e,i,o){var r=this;i.forEach((function(i,a){var s=i.type,l=i.styles,c=i.attrs,u=i.ignoreEvent;[].concat(c).forEach((function(i,c){var h,d,p=null!=u&&u?void 0:r._createFigureEvents(e,2,a,c),v=n(n(n({},o[s]),null===(h=e.styles)||void 0===h?void 0:h[s]),l);null===(d=r.createFigure(s,i,v,p))||void 0===d||d.draw(t)}))}))},e.prototype.getCompleteOverlays=function(t,e){return t.getInstances(e)},e.prototype.getProgressOverlay=function(t,e){return t.paneId===e?t.instance:null},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createPointFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},e.prototype.drawDefaultFigures=function(t,e,i,o,r,a,s,l,c,u,h,d){var p,v,g=this;if(e.needDefaultPointFigure&&((null===(p=h.instance)||void 0===p?void 0:p.id)===e.id&&0!==h.figureType||(null===(v=d.instance)||void 0===v?void 0:v.id)===e.id&&0!==d.figureType)){var f=e.styles,m=n(n({},l.point),null==f?void 0:f.point);i.forEach((function(i,n){var o,r,a,s=i.x,l=i.y,c=m.radius,u=m.color,d=m.borderColor,p=m.borderSize;(null===(o=h.instance)||void 0===o?void 0:o.id)===e.id&&1===h.figureType&&h.figureIndex===n&&(c=m.activeRadius,u=m.activeColor,d=m.activeBorderColor,p=m.activeBorderSize),null===(r=g.createFigure("circle",{x:s,y:l,r:c+p},{color:d},g._createFigureEvents(e,1,n,0)))||void 0===r||r.draw(t),null===(a=g.createFigure("circle",{x:s,y:l,r:c},{color:u}))||void 0===a||a.draw(t)}))}},e}(Ie),Fe=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._gridView=new Ee(n),n._indicatorView=new Me(n),n._crosshairLineView=new Pe(n),n._tooltipView=n.createTooltipView(),n._overlayView=new Ae(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",(function(){return i.getChart().getChartStore().getTooltipStore().setActiveIconInfo(),!1})),n}return i(e,t),e.prototype.getName=function(){return Xt},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.createTooltipView=function(){return new ke(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(ae),Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i,n=this.getWidget(),o=n.getPane(),r=o.getChart(),a=o.getChart().getChartStore(),s=n.getBounding(),l=o.getAxisComponent(),c=a.getTimeScaleStore().getBarSpace(),u=r.getStyles().candle.area,d=[],p=[],g=Number.MAX_SAFE_INTEGER;this.eachChildren((function(t,e,i){var n=t.data,o=t.x,r=e.halfGapBar,a=n[u.value];if(v(a)){var c=l.convertToPixel(a);if(0===i){var h=o-r;p.push({x:h,y:s.height}),p.push({x:h,y:c}),d.push({x:h,y:c})}d.push({x:o,y:c}),p.push({x:o,y:c}),g=Math.min(g,c)}}));var f=p.length;if(f>0){var m=p[f-1],y=m.x+c.halfGapBar;d.push({x:y,y:m.y}),p.push({x:y,y:m.y}),p.push({x:y,y:s.height})}if(d.length>0&&(null===(e=this.createFigure("line",{coordinates:d},{color:u.lineColor,size:u.lineSize}))||void 0===e||e.draw(t)),p.length>0){var _=u.backgroundColor,x=void 0;if(h(_)){var S=t.createLinearGradient(0,s.height,0,g);try{_.forEach((function(t){var e=t.offset,i=t.color;S.addColorStop(e,i)}))}catch(t){}x=S}else x=_;null===(i=this.createFigure("polygon",{coordinates:p},{color:x}))||void 0===i||i.draw(t)}},e}(Te),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this.getWidget().getPane(),i=e.getChart().getChartStore(),n=i.getStyles().candle.priceMark,o=n.high,r=n.low;if(n.show&&(o.show||r.show)){var a=i.getPrecision(),s=e.getAxisComponent(),l=Number.MIN_SAFE_INTEGER,c=0,u=Number.MAX_SAFE_INTEGER,h=0;this.eachChildren((function(t){var e=t.data,i=t.x;l<e.high&&(l=e.high,c=i),u>e.low&&(u=e.low,h=i)}));var d=s.convertToPixel(l),p=s.convertToPixel(u);o.show&&l!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,P(l,a.price),{x:c,y:d},d<p?[-2,-5]:[2,5],o),r.show&&u!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,P(u,a.price),{x:h,y:p},d<p?[2,5]:[-2,-5],r)}},e.prototype._drawMark=function(t,e,i,n,o){var r,a,s,l,c,u,h=i.x,d=i.y+n[0];null===(r=this.createFigure("line",{coordinates:[{x:h-2,y:d+n[0]},{x:h,y:d},{x:h+2,y:d+n[0]}]},{color:o.color}))||void 0===r||r.draw(t),h>this.getWidget().getBounding().width/2?(c=(l=h-5)-o.textOffset,u="right"):(u="left",c=(l=h+5)+o.textOffset);var p=d+n[1];null===(a=this.createFigure("line",{coordinates:[{x:h,y:d},{x:h,y:p},{x:l,y:p}]},{color:o.color}))||void 0===a||a.draw(t),null===(s=this.createFigure("text",{x:c,y:p,text:e,align:u,baseline:"middle"},{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}))||void 0===s||s.draw(t)},e}(Te),Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getStyles().candle.priceMark,s=a.last,l=s.line;if(a.show&&s.show&&l.show){var c=n.getAxisComponent(),u=r.getDataList(),h=u[u.length-1];if(null!=h){var d=h.close,p=h.open,v=c.convertToNicePixel(d),g=void 0;g=d>p?s.upColor:d<p?s.downColor:s.noChangeColor,null===(e=this.createFigure("line",{coordinates:[{x:0,y:v},{x:o.width,y:v}]},{style:l.style,color:g,size:l.size,dashedValue:l.dashedValue}))||void 0===e||e.draw(t)}}},e}(Ie),Ne={"zh-CN":{time:"\u65f6\u95f4\uff1a",open:"\u5f00\uff1a",high:"\u9ad8\uff1a",low:"\u4f4e\uff1a",close:"\u6536\uff1a",volume:"\u6210\u4ea4\u91cf\uff1a"},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: "}};function Oe(t,e){var i,n;return null!==(n=null===(i=Ne[e])||void 0===i?void 0:i[t])&&void 0!==n?n:t}var Ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=n.getId(),r=n.getChart().getChartStore(),a=r.getCrosshairStore().get();if(void 0!==a.kLineData){var s=i.getBounding(),l=null===(e=n.getYAxisWidget())||void 0===e?void 0:e.getBounding(),c=r.getDataList(),u=r.getPrecision(),h=r.getLocale(),d=r.getCustomApi(),p=r.getTooltipStore().getActiveIconInfo(),v=r.getIndicatorStore().getInstances(n.getId()),g=r.getTimeScaleStore().getDateTimeFormat(),f=r.getStyles(),m=f.candle,y=f.indicator;if(m.tooltip.showType===x.Rect&&y.tooltip.showType===x.Rect){var _=this.isDrawTooltip(a,m.tooltip),S=this.isDrawTooltip(a,y.tooltip);this._drawRectTooltip(t,c,v,s,l,a,u,g,h,d,_,S,f,0)}else if(m.tooltip.showType===x.Standard&&y.tooltip.showType===x.Standard){var C=this._drawCandleStandardTooltip(t,c,o,s,a,p,u,g,h,d,m);this.drawIndicatorTooltip(t,o,c,a,p,v,d,s,y,C)}else if(m.tooltip.showType===x.Rect&&y.tooltip.showType===x.Standard){var b=this.drawIndicatorTooltip(t,o,c,a,p,v,d,s,y,0);_=this.isDrawTooltip(a,m.tooltip),this._drawRectTooltip(t,c,v,s,l,a,u,g,h,d,_,!1,f,b)}else{var w=this._drawCandleStandardTooltip(t,c,o,s,a,p,u,g,h,d,m);S=this.isDrawTooltip(a,y.tooltip),this._drawRectTooltip(t,c,v,s,l,a,u,g,h,d,!1,S,f,w)}}},e.prototype._drawCandleStandardTooltip=function(t,e,i,n,o,r,a,l,c,u,h){var d,p,v,g=h.tooltip,f=g.text,m=0;if(this.isDrawTooltip(o,g)){var y=null!==(d=o.dataIndex)&&void 0!==d?d:0,_=this._getCandleTooltipData({prev:null!==(p=e[y-1])&&void 0!==p?p:null,current:o.kLineData,next:null!==(v=e[y+1])&&void 0!==v?v:null},a,l,c,u,h),x=0,S=0,C=0,b=s(this.classifyTooltipIcons(g.icons),3),w=b[0],I=b[1],E=b[2],T=s(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,w,x,S,0),4),D=T[0],M=T[1],P=T[2];x=D,S=M,m+=T[3],C=P;var k=s(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,I,x,S,C),4),A=k[0],F=k[1],L=k[2];if(x=A,S=F,m+=k[3],C=L,_.length>0){var R=s(this.drawStandardTooltipLabels(t,n,_,x,S,C,f),4),B=R[0],N=R[1],O=R[2];x=B,S=N,m+=R[3],C=O}var V=s(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,E,x,S,C),4),W=V[0],z=V[1],Y=V[2];x=W,S=z,m+=V[3],C=Y}return m},e.prototype._drawRectTooltip=function(t,e,i,n,o,r,a,s,l,c,u,h,d,p){var v,g,f,m,_,x=this,S=d.candle,C=d.indicator,w=S.tooltip,I=C.tooltip;if(u||h){var E=null!==(v=r.dataIndex)&&void 0!==v?v:0,T=this._getCandleTooltipData({prev:null!==(g=e[E-1])&&void 0!==g?g:null,current:r.kLineData,next:null!==(f=e[E+1])&&void 0!==f?f:null},a,s,l,c,S),D=w.text,M=D.marginLeft,P=D.marginRight,k=D.marginTop,A=D.marginBottom,F=D.size,L=D.weight,R=D.family,B=w.rect,N=B.paddingLeft,O=B.paddingRight,V=B.paddingTop,z=B.paddingBottom,Y=B.offsetLeft,X=B.offsetRight,H=B.offsetTop,j=B.borderSize,G=B.borderRadius,U=B.borderColor,Z=B.color,q=0,K=0,J=0;u&&(t.font=W(F,L,R),T.forEach((function(e){var i=e.title,n=e.value,o="".concat(i.text).concat(n.text),r=t.measureText(o).width+M+P;q=Math.max(q,r)})),J+=(A+k+F)*T.length);var $=I.text,Q=$.marginLeft,tt=$.marginRight,et=$.marginTop,it=$.marginBottom,nt=$.size,ot=$.weight,rt=$.family,at=[];if(h&&(t.font=W(nt,ot,rt),i.forEach((function(i){var n,o=null!==(n=x.getIndicatorTooltipData(e,r,i,c,C).values)&&void 0!==n?n:[];at.push(o),o.forEach((function(e){var i=e.title,n=e.value,o="".concat(i.text).concat(n.text),r=t.measureText(o).width+Q+tt;q=Math.max(q,r),J+=et+it+nt}))}))),0!==(K+=q)&&0!==J){K+=2*j+N+O,J+=2*j+V+z;var st,lt=n.width/2;(null!==(m=r.realX)&&void 0!==m?m:0)<lt?(st=n.width-X-K,d.yAxis.inside&&d.yAxis.position===b.Right&&(st-=o.width)):(st=Y,d.yAxis.inside&&d.yAxis.position===b.Left&&(st+=o.width));var ct=p+H;null===(_=this.createFigure("rect",{x:st,y:ct,width:K,height:J},{style:y.StrokeFill,color:Z,borderColor:U,borderSize:j,borderRadius:G}))||void 0===_||_.draw(t);var ut=st+j+N+M,ht=ct+j+V;if(u&&T.forEach((function(e){var i,n;ht+=k;var o=e.title;null===(i=x.createFigure("text",{x:ut,y:ht,text:o.text},{color:o.color,size:F,family:R,weight:L}))||void 0===i||i.draw(t);var r=e.value;null===(n=x.createFigure("text",{x:st+K-j-P-O,y:ht,text:r.text,align:"right"},{color:r.color,size:F,family:R,weight:L}))||void 0===n||n.draw(t),ht+=F+A})),h){var dt=st+j+N+Q;at.forEach((function(e){e.forEach((function(e){var i,n;ht+=et;var o=e.title,r=e.value;null===(i=x.createFigure("text",{x:dt,y:ht,text:o.text},{color:o.color,size:nt,family:rt,weight:ot}))||void 0===i||i.draw(t),null===(n=x.createFigure("text",{x:st+K-j-tt-O,y:ht,text:r.text,align:"right"},{color:r.color,size:nt,family:rt,weight:ot}))||void 0===n||n.draw(t),ht+=nt+it}))}))}}}},e.prototype._getCandleTooltipData=function(t,e,i,n,o,r){var a,s,l,c=r.tooltip,u=c.text.color,h=[];if(d(c.custom))(null!==(s=null===(a=c.custom)||void 0===a?void 0:a.call(c,t,r))&&void 0!==s?s:[]).forEach((function(t){var e=t.title,i=t.value,o={text:"",color:""};p(e)?o=e:(o.text=e,o.color=u),o.text=Oe(o.text,n);var r={text:"",color:""};p(i)?r=i:(r.text=i,r.color=u),h.push({title:o,value:r})}));else{var v=e.price,g=e.volume,f=t.current;h=[{title:{text:Oe("time",n),color:u},value:{text:o.formatDate(i,f.timestamp,"YYYY-MM-DD HH:mm",I.Tooltip),color:u}},{title:{text:Oe("open",n),color:u},value:{text:P(f.open,v),color:u}},{title:{text:Oe("high",n),color:u},value:{text:P(f.high,v),color:u}},{title:{text:Oe("low",n),color:u},value:{text:P(f.low,v),color:u}},{title:{text:Oe("close",n),color:u},value:{text:P(f.close,v),color:u}},{title:{text:Oe("volume",n),color:u},value:{text:o.formatBigNumber(P(null!==(l=f.volume)&&void 0!==l?l:c.defaultValue,g)),color:u}}]}return h},e}(ke),We=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._candleBarView=new De(e),e._candleAreaView=new Le(e),e._candleHighLowPriceView=new Re(e),e._candleLastPriceLineView=new Be(e),e}return i(e,t),e.prototype.updateMainContent=function(t){this.getPane().getChart().getStyles().candle.type!==C.Area?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t),this._candleLastPriceLineView.draw(t)):this._candleAreaView.draw(t)},e.prototype.createTooltipView=function(){return new Ve(this)},e}(Fe),ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getAxisComponent(),s=this.getAxisStyles(o.getChart().getStyles());if(s.show){s.axisLine.show&&(null===(e=this.createFigure("line",this.createAxisLine(r,s),s.axisLine))||void 0===e||e.draw(t));var l=a.getTicks();s.tickLine.show&&this.createTickLines(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("line",e,s.tickLine))||void 0===n||n.draw(t)})),s.tickText.show&&this.createTickTexts(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("text",e,s.tickText))||void 0===n||n.draw(t)}))}},e}(Ie),Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i,n=this.getWidget().getPane().getAxisComponent(),o=e.axisLine.size;return{coordinates:[{x:i=n.isFromZero()?o/2:t.width-o,y:0},{x:i,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=0,s=0;return n.isFromZero()?(a=0,o.show&&(a+=o.size),s=a+r.length):(a=e.width,o.show&&(a-=o.size),s=a-r.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=i.tickText,s=0;n.isFromZero()?(s=a.marginStart,o.show&&(s+=o.size),r.show&&(s+=r.length)):(s=e.width-a.marginEnd,o.show&&(s-=o.size),r.show&&(s-=r.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}(ze),Xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),o=i.getPane(),r=i.getBounding(),a=o.getChart().getChartStore(),s=a.getStyles().candle.priceMark,l=s.last,c=l.text;if(s.show&&l.show&&c.show){var u=a.getPrecision(),h=o.getAxisComponent(),d=a.getDataList(),p=a.getVisibleDataList(),v=d[d.length-1];if(void 0!==v){var g=v.close,f=v.open,m=h.convertToNicePixel(g),y=void 0;y=g>f?l.upColor:g<f?l.downColor:l.noChangeColor;var _=void 0;if(h.getType()===w.Percentage){var x=p[0].data.close;_="".concat(((g-x)/x*100).toFixed(2),"%")}else _=P(g,u.price);var S=void 0,C=void 0;h.isFromZero()?(S=0,C="left"):(S=r.width,C="right"),null===(e=this.createFigure("rectText",{x:S,y:m,text:_,align:C,baseline:"middle"},n(n({},c),{backgroundColor:y})))||void 0===e||e.draw(t)}}},e}(Ie),He=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),o=i.getPane(),r=i.getBounding(),a=o.getChart().getChartStore(),s=a.getCustomApi(),l=a.getStyles().indicator,c=l.lastValueMark,u=c.text;if(c.show){var h=o.getAxisComponent(),d=a.getDataList(),p=d.length-1;a.getIndicatorStore().getInstances(o.getId()).forEach((function(i){var o=i.result[p];if(void 0!==o&&i.visible){var a=i.precision;Q(d,i,p,l,(function(l,c){var d,p=o[l.key];if(g(p)){var v=h.convertToNicePixel(p),f=P(p,a);i.shouldFormatBigNumber&&(f=s.formatBigNumber(f));var m=void 0,y=void 0;h.isFromZero()?(m=0,y="left"):(m=r.width,y="right"),null===(d=e.createFigure("rectText",{x:m,y:v,text:f,align:y,baseline:"middle"},n(n({},u),{backgroundColor:c.color})))||void 0===d||d.draw(t)}}))}}))}},e}(Ie),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,c,u,h){this.drawFigures(t,e,this.getDefaultFigures(e,i,n,o,r,a,l,c,h),s)},e.prototype.getDefaultFigures=function(t,e,i,n,o,r,a,s,l){var c,u,h=[];if(t.needDefaultYAxisFigure&&t.id===(null===(c=l.instance)||void 0===c?void 0:c.id)&&l.paneId===this.getWidget().getPane().getId()){var d,p,v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;null!==(u=null==s?void 0:s.isFromZero())&&void 0!==u&&u?(d="left",p=0):(d="right",p=i.width),e.forEach((function(e,i){var o=t.points[i];if(void 0!==o.value){v=Math.min(v,e.y),g=Math.max(g,e.y);var r=P(o.value,n.price);h.push({type:"rectText",attrs:{x:p,y:e.y,text:r,align:d,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&h.unshift({type:"rect",attrs:{x:0,y:v,width:i.width,height:g-v},ignoreEvent:!0})}return h},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createYAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},e}(Ae),Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=i.getPane().getChart().getChartStore(),a=r.getCrosshairStore().get(),s=r.getStyles().crosshair;if(void 0!==a.paneId&&void 0!==a.kLineData&&this.checkPaneId(a,n.getId())&&s.show){var l=this.getDirectionStyles(s),c=l.text;if(l.show&&c.show){var u=n.getAxisComponent(),h=this.getText(a,r,u);t.font=W(c.size,c.weight,c.family),null===(e=this.createFigure("rectText",this.getTextAttrs(h,t.measureText(h).width,a,o,u,c),c))||void 0===e||e.draw(t)}}},e.prototype.checkPaneId=function(t,e){return t.paneId===e},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,e,i){var n,o,r,a=i,s=i.convertFromPixel(t.y);if(a.getType()===w.Percentage){var l=null!==(o=null===(n=e.getVisibleDataList()[0])||void 0===n?void 0:n.data)&&void 0!==o?o:{};r="".concat(((s-l.close)/l.close*100).toFixed(2),"%")}else{var c=e.getIndicatorStore().getInstances(t.paneId),u=0,h=!1;a.isInCandle()?u=e.getPrecision().price:c.forEach((function(t){u=Math.max(t.precision,u),h||(h=t.shouldFormatBigNumber)})),r=P(s,u),h&&(r=e.getCustomApi().formatBigNumber(r))}return r},e.prototype.getTextAttrs=function(t,e,i,n,o,r){var a,s;return o.isFromZero()?(a=0,s="left"):(a=n.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},e}(Ie),Ue=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._yAxisView=new Ye(n),n._candleLastPriceLabelView=new Xe(n),n._indicatorLastValueView=new He(n),n._overlayYAxisView=new je(n),n._crosshairHorizontalLabelView=new Ge(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return i(e,t),e.prototype.getName=function(){return jt},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t)},e}(ae),Ze=function(){function t(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!t)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},t.prototype.getTicks=function(){return this._ticks},t.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},t.prototype.getExtremum=function(){return this._extremum},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,i=t.realMax,n=t.realRange,o=[];if(n>=0){var r=s(this._calcTickInterval(n),2),a=r[0],l=r[1],c=X(Math.ceil(e/a)*a,l),u=X(Math.floor(i/a)*a,l),h=0,d=c;if(0!==a)for(;d<=u;){var p=d.toFixed(l);o[h]={text:p,coord:0,value:p},++h,d+=a}}return o},t.prototype._calcTickInterval=function(t){var e,i,n,o,r=(e=t/8,i=Math.floor(j(e)),n=G(i),e=((o=e/n)<1.5?1:o<2.5?2:o<3.5?3:o<4.5?4:o<5.5?5:o<6.5?6:8)*n,i>=-20?+e.toFixed(i<0?-i:0):e),a=function(t){var e=t.toString(),i=e.indexOf("e");if(i>0){var n=+e.slice(i+1);return n<0?-n:0}var o=e.indexOf(".");return o<0?0:e.length-1-o}(r);return[r,a]},t}(),qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.calcExtremum=function(){var t,e,i,n,o,r=this.getParent(),a=r.getChart(),s=a.getChartStore(),l=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,u=[],h=!1,d=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,v=Number.MAX_SAFE_INTEGER;s.getIndicatorStore().getInstances(r.getId()).forEach((function(t){var e,i,n;h||(h=null!==(e=t.shouldOhlc)&&void 0!==e&&e),v=Math.min(v,t.precision),null!==t.minValue&&(d=Math.min(d,t.minValue)),null!==t.maxValue&&(p=Math.max(p,t.maxValue)),u.push({figures:null!==(i=t.figures)&&void 0!==i?i:[],result:null!==(n=t.result)&&void 0!==n?n:[]})}));var f=4,m=this.isInCandle();if(m){var y=s.getPrecision().price;f=v!==Number.MAX_SAFE_INTEGER?Math.min(v,y):y}else v!==Number.MAX_SAFE_INTEGER&&(f=v);var _=s.getVisibleDataList(),x=a.getStyles().candle,S=x.type===C.Area,b=x.area.value,I=m&&!S||!m&&h;_.forEach((function(t){var e=t.dataIndex,i=t.data;I&&(l=Math.min(l,i.low),c=Math.max(c,i.high)),m&&S&&(l=Math.min(l,i[b]),c=Math.max(c,i[b])),u.forEach((function(t){var i,n=t.figures,o=null!==(i=t.result[e])&&void 0!==i?i:{};n.forEach((function(t){var e=o[t.key];g(e)&&(l=Math.min(l,e),c=Math.max(c,e))}))}))})),l!==Number.MAX_SAFE_INTEGER&&c!==Number.MIN_SAFE_INTEGER?(l=Math.min(d,l),c=Math.max(p,c)):(l=0,c=10);var E,T=this.getType();switch(T){case w.Percentage:var D=null===(t=_[0])||void 0===t?void 0:t.data;void 0!==(null==D?void 0:D.close)&&(l=(l-D.close)/D.close*100,c=(c-D.close)/D.close*100),E=Math.pow(10,-2);break;case w.Log:l=j(l),c=j(c),E=.05*G(-f);break;default:E=G(-f)}if(l===c||Math.abs(l-c)<E){var M=d===l,P=p===c;l=M?l:P?l-8*E:l-4*E,c=P?c:M?c+8*E:c+4*E}var k=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,A=r.getOptions().gap,F=null!==(n=null==A?void 0:A.top)&&void 0!==n?n:.2;F>=1&&(F/=k);var L=null!==(o=null==A?void 0:A.bottom)&&void 0!==o?o:.1;L>=1&&(L/=k);var R,B,N,O=Math.abs(c-l);return l-=O*L,c+=O*F,O=Math.abs(c-l),T===w.Log?(R=G(l),B=G(c),N=Math.abs(B-R)):(R=l,B=c,N=O),{min:l,max:c,range:O,realMin:R,realMax:B,realRange:N}},e.prototype._innerConvertToPixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.getExtremum(),r=(t-o.min)/o.range;return this.isReverse()?Math.round(r*n):Math.round((1-r)*n)},e.prototype.isInCandle=function(){return"candle"===this.getParent().getName()},e.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:w.Normal},e.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},e.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},e.prototype.isFromZero=function(){var t=this.getParent().getChart().getStyles().yAxis,e=t.inside;return t.position===b.Left&&e||t.position===b.Right&&!e},e.prototype.optimalTicks=function(t){var e,i,n=this,o=this.getParent(),r=null!==(i=null===(e=o.getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,a=o.getChart().getChartStore(),s=a.getCustomApi(),l=[],c=this.getType(),u=a.getIndicatorStore().getInstances(o.getId()),h=0,d=!1;this.isInCandle()?h=a.getPrecision().price:u.forEach((function(t){h=Math.max(h,t.precision),d||(d=t.shouldFormatBigNumber)}));var p,v=a.getStyles().xAxis.tickText.size;return t.forEach((function(t){var e,i=t.value,o=n._innerConvertToPixel(+i);switch(c){case w.Percentage:e="".concat(P(i,2),"%");break;case w.Log:o=n._innerConvertToPixel(j(+i)),e=P(i,h);break;default:e=P(i,h),d&&(e=s.formatBigNumber(i))}o>v&&o<r-v&&(void 0!==p&&Math.abs(p-o)>2*v||void 0===p)&&(l.push({text:e,coord:o,value:i}),p=o)})),l},e.prototype.getAutoSize=function(){var t=this.getParent(),e=t.getChart(),i=e.getStyles(),n=i.yAxis,o=n.size;if("auto"!==o)return o;var r=e.getChartStore(),a=r.getCustomApi(),s=0;if(n.show&&(n.axisLine.show&&(s+=n.axisLine.size),n.tickLine.show&&(s+=n.tickLine.length),n.tickText.show)){var l=0;this.getTicks().forEach((function(t){l=Math.max(l,z(t.text,n.tickText.size,n.tickText.weight,n.tickText.family))})),s+=n.tickText.marginStart+n.tickText.marginEnd+l}var c=i.crosshair,u=0;if(c.show&&c.horizontal.show&&c.horizontal.text.show){var h=r.getIndicatorStore().getInstances(t.getId()),d=0,p=!1;h.forEach((function(t){d=Math.max(t.precision,d),p||(p=t.shouldFormatBigNumber)}));var v=2;if(this.getType()!==w.Percentage)if(this.isInCandle()){var g=r.getPrecision().price,f=i.indicator.lastValueMark;v=f.show&&f.text.show?Math.max(d,g):g}else v=d;var m=P(this.getExtremum().max,v);p&&(m=a.formatBigNumber(m)),u+=c.horizontal.text.paddingLeft+c.horizontal.text.paddingRight+2*c.horizontal.text.borderSize+z(m,c.horizontal.text.size,c.horizontal.text.weight,c.horizontal.text.family)}return Math.max(s,u)},e.prototype.convertFromPixel=function(t){var e,i,n,o=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,r=this.getExtremum(),a=r.min,s=r.range,l=(this.isReverse()?t/o:1-t/o)*s+a;switch(this.getType()){case w.Percentage:var c=null===(n=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===n?void 0:n.data;return void 0!==(null==c?void 0:c.close)?c.close*l/100+c.close:0;case w.Log:return G(l);default:return l}},e.prototype.convertToRealValue=function(t){var e=t;return this.getType()===w.Log&&(e=G(t)),e},e.prototype.convertToPixel=function(t){var e,i=t;switch(this.getType()){case w.Percentage:var n=null===(e=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===e?void 0:e.data;void 0!==(null==n?void 0:n.close)&&(i=(t-n.close)/n.close*100);break;case w.Log:i=j(t);break;default:i=t}return this._innerConvertToPixel(i)},e.prototype.convertToNicePixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.convertToPixel(t);return Math.round(Math.max(.05*n,Math.min(o,.98*n)))},e}(Ze),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getName=function(){return"indicator"},e.prototype.createAxisComponent=function(){return new qe(this)},e.prototype.createMainWidget=function(t){return new Fe(t,this)},e.prototype.createSeparatorWidget=function(t){return new Zt(t,this)},e.prototype.creatYAxisWidget=function(t){return new Ue(t,this)},e}(Jt),Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getName=function(){return"candle"},e.prototype.createMainWidget=function(t){return new We(t,this)},e.prototype.createSeparatorWidget=function(){return null},e}(Ke),$e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,e){var i=e.axisLine.size/2;return{coordinates:[{x:0,y:i},{x:t.width,y:i}]}},e.prototype.createTickLines=function(t,e,i){var n=i.tickLine,o=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:o+n.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=i.tickText,o=i.axisLine.size,r=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:o+r+n.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}(ze),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.coordinateToPointValueFlag=function(){return!1},e.prototype.getCompleteOverlays=function(t){return t.getInstances()},e.prototype.getProgressOverlay=function(t){return t.instance},e.prototype.getDefaultFigures=function(t,e,i,n,o,r,a,s,l){var c,u=[];if(t.needDefaultXAxisFigure&&t.id===(null===(c=l.instance)||void 0===c?void 0:c.id)){var h=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;e.forEach((function(e,i){h=Math.min(h,e.x),d=Math.max(d,e.x);var n=t.points[i];if(void 0!==n.timestamp){var a=r.formatDate(o,n.timestamp,"YYYY-MM-DD HH:mm",I.Crosshair);u.push({type:"rectText",attrs:{x:e.x,y:0,text:a,align:"center"},ignoreEvent:!0})}})),e.length>1&&u.unshift({type:"rect",attrs:{x:h,y:0,width:d-h,height:i.height},ignoreEvent:!0})}return u},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createXAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},e}(je),ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkPaneId=function(t){return t.dataIndex===t.realDataIndex},e.prototype.getDirectionStyles=function(t){return t.vertical},e.prototype.getText=function(t,e){var i,n=null===(i=t.kLineData)||void 0===i?void 0:i.timestamp;return e.getCustomApi().formatDate(e.getTimeScaleStore().getDateTimeFormat(),n,"YYYY-MM-DD HH:mm",I.Crosshair)},e.prototype.getTextAttrs=function(t,e,i,n,o,r){var a=i.realX;return{x:a-e/2-r.paddingLeft<0?r.paddingLeft+e/2:a+e/2+r.paddingRight>n.width?n.width-r.paddingRight-e/2:a,y:0,text:t,align:"center",baseline:"top"}},e}(Ge),ei=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._xAxisView=new $e(n),n._overlayXAxisView=new Qe(n),n._crosshairVerticalLabelView=new ti(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return i(e,t),e.prototype.getName=function(){return Ht},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(ae),ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),e=t.from,i=t.to,n=i-1,o=i-e;return{min:e,max:n,range:o,realMin:e,realMax:n,realRange:o}},e.prototype.optimalTicks=function(t){var e,i,n=this.getParent().getChart(),o=n.getChartStore(),r=o.getCustomApi().formatDate,a=[],s=t.length,l=o.getDataList();if(s>0){var c=o.getTimeScaleStore().getDateTimeFormat(),u=n.getStyles().xAxis.tickText,h=z("00-00 00:00",u.size,u.weight,u.family),d=parseInt(t[0].value,10),p=this.convertToPixel(d),v=1;if(s>1){var g=parseInt(t[1].value,10),f=this.convertToPixel(g),m=Math.abs(f-p);m<h&&(v=Math.ceil(h/m))}for(var y=0;y<s;y+=v){var _=parseInt(t[y].value,10),x=l[_].timestamp,S=r(c,x,"HH:mm",I.XAxis);if(0!==y){var C=l[parseInt(t[y-v].value,10)].timestamp;S=null!==(e=this._optimalTickLabel(r,c,x,C))&&void 0!==e?e:S}var b=this.convertToPixel(_);a.push({text:S,coord:b,value:x})}if(1===a.length)a[0].text=r(c,a[0].value,"YYYY-MM-DD HH:mm",I.XAxis);else{var w=a[0].value,E=a[1].value;if(void 0!==a[2]){var T=a[2].text;/^[0-9]{2}-[0-9]{2}$/.test(T)?a[0].text=r(c,w,"MM-DD",I.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(T)?a[0].text=r(c,w,"YYYY-MM",I.XAxis):/^[0-9]{4}$/.test(T)&&(a[0].text=r(c,w,"YYYY",I.XAxis))}else a[0].text=null!==(i=this._optimalTickLabel(r,c,w,E))&&void 0!==i?i:a[0].text}}return a},e.prototype._optimalTickLabel=function(t,e,i,n){var o=t(e,i,"YYYY",I.XAxis),r=t(e,i,"YYYY-MM",I.XAxis),a=t(e,i,"MM-DD",I.XAxis);return o!==t(e,n,"YYYY",I.XAxis)?o:r!==t(e,n,"YYYY-MM",I.XAxis)?r:a!==t(e,n,"MM-DD",I.XAxis)?a:null},e.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var n=t.crosshair,o=0;e.show&&(e.axisLine.show&&(o+=e.axisLine.size),e.tickLine.show&&(o+=e.tickLine.length),e.tickText.show&&(o+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var r=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(r+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+2*n.vertical.text.borderSize+n.vertical.text.size),Math.max(o,r)},e.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},e.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},e}(Ze),ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getName=function(){return"xAxis"},e.prototype.createAxisComponent=function(){return new ii(this)},e.prototype.createMainWidget=function(t){return new ei(t,this)},e}(Jt);function oi(){var t;return"undefined"!=typeof window&&(null!==(t=window.navigator.userAgent.toLowerCase().indexOf("firefox"))&&void 0!==t?t:-1)>-1}function ri(){return"undefined"!=typeof window&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var ai,si=function(){function t(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!ri(),this._onFirefoxOutsideMouseUp=function(t){n._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){n._firesTouchEvents(t)?(++n._tapCount,null!==n._tapTimeoutId&&n._tapCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._tapCoordinate).manhattanDistance<30&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(t),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,null!==n._clickTimeoutId&&n._clickCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._clickCoordinate).manhattanDistance<5&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(t),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,n,o=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this);var r=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){o._target.removeEventListener("mousemove",r)},this._target.addEventListener("mousemove",r);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){o._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){o._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(void 0===this._handler.mouseWheelHortEvent)return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(void 0===this._handler.mouseWheelVertEvent)return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.xOffset,o=i.yOffset,r=i.manhattanDistance;if(this._touchMoveExceededManhattanDistance||!(r<5)){if(!this._touchMoveExceededManhattanDistance){var a=.5*n,s=o>=a&&!this._options.treatVertDragAsPageScroll(),l=a>o&&!this._options.treatHorzDragAsPageScroll();s||l||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){0===t.button&&(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return{xOffset:i,yOffset:n,manhattanDistance:i+n}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1?(this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance<30&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout()):this._cancelTap||(this._processEvent(i,this._handler.tapEvent),void 0!==this._handler.tapEvent&&this._preventDefault(t)),0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(0===t.button){var e=this._makeCompatEvent(t);this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),oi()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._firesTouchEvents(t)||(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1?(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent))}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),o=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),240),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(2===t.button)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(0===t.button){var e=this._target.ownerDocument.documentElement;oi()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),ri()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&void 0!==t._handler.pinchEvent){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(n(n({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e,i=null!==(e=this._target.getBoundingClientRect())&&void 0!==e?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,n;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!ri())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return void 0!==(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i,n=this,o=null!=e?e:t,r=null!==(i=this._target.getBoundingClientRect())&&void 0!==i?i:{left:0,top:0};return{x:o.clientX-r.left,y:o.clientY-r.top,pageX:o.pageX,pageY:o.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,preventDefault:function(){"touchstart"!==t.type&&n._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},t}(),li=function(){function t(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollTimerId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new si(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return t.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},t.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,o=i.widget;if((null==n?void 0:n.getId())!==Kt.XAXIS&&(null==o?void 0:o.getName())===Xt){var r=this._makeWidgetEvent(t,o),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(a,{x:r.x,y:r.y}),!0}return!1},t.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},t.prototype.mouseWheelVertEvent=function(t,e){var i,n,o=this._findWidgetByEvent(t).widget,r=null!==(i=t.isTouch)&&void 0!==i&&i,a=this._makeWidgetEvent(t,o),s=null,l=null==o?void 0:o.getName();if(r)if(l===Xt||l===Ht)s={x:a.x,y:a.y};else{var c=null===(n=this._chart.getPaneById(Kt.CANDLE))||void 0===n?void 0:n.getBounding();s={x:c.width/2,y:c.height/2}}else l===Xt&&(s={x:a.x,y:a.y});return null!==s&&(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:a.x,y:a.y}),!0)},t.prototype.mouseDownEvent=function(t){var e,i,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget;if(this._mouseDownWidget=a,null!==a){var s=this._makeWidgetEvent(t,a);switch(a.getName()){case Gt:return a.dispatchEvent("mouseDownEvent",s);case Xt:var l=null!==(e=null==r?void 0:r.getAxisComponent().getExtremum())&&void 0!==e?e:null;return this._prevYAxisExtremum=null===l?l:n({},l),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),a.dispatchEvent("mouseDownEvent",s);case Ht:return(c=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,c;case jt:var c;return(c=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),l=null!==(i=null==r?void 0:r.getAxisComponent().getExtremum())&&void 0!==i?i:null,this._prevYAxisExtremum=null===l?l:n({},l),this._yAxisStartScaleDistance=s.pageY,c}}return!1},t.prototype.mouseMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==r?void 0:r.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(n=this._mouseMoveTriggerWidgetInfo.widget)||void 0===n||n.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:r,widget:a}),null!==a)switch(a.getName()){case Xt:var l=a.dispatchEvent("mouseMoveEvent",s),c=this._chart.getChartStore(),u={x:s.x,y:s.y,paneId:null==r?void 0:r.getId()};return l&&null!==c.getTooltipStore().getActiveIconInfo()&&(u=void 0,null!==a&&(a.getContainer().style.cursor="pointer")),this._chart.getChartStore().getCrosshairStore().set(u),l;case Gt:case Ht:case jt:return l=a.dispatchEvent("mouseMoveEvent",s),this._chart.getChartStore().getCrosshairStore().set(),l}return!1},t.prototype.pressedMouseMoveEvent=function(t){var e,i,n,o;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===Gt)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var r=this._findWidgetByEvent(t),a=r.pane,s=r.widget;if(null!==s&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==a?void 0:a.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===s.getName()){var l=this._makeWidgetEvent(t,s);switch(s.getName()){case Xt:var c=s.getBounding();if(!(x=s.dispatchEvent("pressedMouseMoveEvent",l))&&null!==this._startScrollCoordinate){var u=null==a?void 0:a.getAxisComponent();if(null!==this._prevYAxisExtremum&&!u.getAutoCalcTickFlag()){var h=this._prevYAxisExtremum,d=h.min,p=h.max,v=d+(b=(S=h.range)*(C=(null!==(n=null==u?void 0:u.isReverse())&&void 0!==n&&n?this._startScrollCoordinate.y-l.y:l.y-this._startScrollCoordinate.y)/c.height)),g=p+b,f=u.convertToRealValue(v),m=u.convertToRealValue(g);u.setExtremum({min:v,max:g,range:g-v,realMin:f,realMax:m,realRange:m-f})}var y=l.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(y)}return this._chart.getChartStore().getCrosshairStore().set({x:l.x,y:l.y,paneId:null==a?void 0:a.getId()}),x;case Ht:if(x=s.dispatchEvent("pressedMouseMoveEvent",l))this._chart.updatePane(1);else{var _=10*((C=this._xAxisStartScaleDistance/l.pageX)-this._xAxisScale);this._xAxisScale=C,this._chart.getChartStore().getTimeScaleStore().zoom(_,null!==(o=this._xAxisStartScaleCoordinate)&&void 0!==o?o:void 0)}return x;case jt:var x;if(x=s.dispatchEvent("pressedMouseMoveEvent",l))this._chart.updatePane(1);else if(null!==this._prevYAxisExtremum){var S,C,b,w=this._prevYAxisExtremum,I=(d=w.min,p=w.max,(S=w.range)*(C=l.pageY/this._yAxisStartScaleDistance));v=d-(b=(I-S)/2),g=p+b,f=(u=null==a?void 0:a.getAxisComponent()).convertToRealValue(v),m=u.convertToRealValue(g),u.setExtremum({min:v,max:g,range:I,realMin:f,realMax:m,realRange:m-f}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}return x}}return!1},t.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Xt:case Gt:case Ht:case jt:i=e.dispatchEvent("mouseUpEvent",n)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},t.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Xt:case Ht:case jt:i=e.dispatchEvent("mouseRightClickEvent",n)}i&&this._chart.updatePane(1)}return!1},t.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===jt){var o=null==i?void 0:i.getAxisComponent();if(!o.getAutoCalcTickFlag())return o.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},t.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getCrosshairStore().set(),!0},t.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n){var o=this._makeWidgetEvent(t,n);switch(n.getName()){case Xt:var r=this._chart.getChartStore(),a=r.getCrosshairStore();if(n.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.set(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._flingScrollTimerId&&(clearTimeout(this._flingScrollTimerId),this._flingScrollTimerId=null),this._flingStartTime=(new Date).getTime(),this._startScrollCoordinate={x:o.x,y:o.y},r.getTimeScaleStore().startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var s=o.x-this._touchCoordinate.x,l=o.y-this._touchCoordinate.y;Math.sqrt(s*s+l*l)<10?(this._touchCoordinate={x:o.x,y:o.y},a.set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()})):(this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.set())}else this._touchCancelCrosshair=!1;return!0;case Ht:case jt:var c=n.dispatchEvent("mouseDownEvent",o);return c&&this._chart.updatePane(1),c}}return!1},t.prototype.touchMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget;if(null!==a){var s=this._makeWidgetEvent(t,a);switch(a.getName()){case Xt:if(a.dispatchEvent("pressedMouseMoveEvent",s))return null===(e=s.preventDefault)||void 0===e||e.call(s),this._chart.updatePane(1),!0;var l=this._chart.getChartStore();if(null!==this._touchCoordinate)null===(i=s.preventDefault)||void 0===i||i.call(s),l.getCrosshairStore().set({x:s.x,y:s.y,paneId:null==r?void 0:r.getId()});else if(null!==this._startScrollCoordinate&&Math.abs(this._startScrollCoordinate.x-s.x)>this._startScrollCoordinate.y-s.y){var c=s.x-this._startScrollCoordinate.x;l.getTimeScaleStore().scroll(c)}return!0;case Ht:case jt:var u=a.dispatchEvent("pressedMouseMoveEvent",s);return u&&(null===(n=s.preventDefault)||void 0===n||n.call(s),this._chart.updatePane(1)),u}}return!1},t.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var n=this._makeWidgetEvent(t,i);switch(i.getName()){case Xt:if(i.dispatchEvent("mouseUpEvent",n),null!==this._startScrollCoordinate){var o=(new Date).getTime()-this._flingStartTime,r=(n.x-this._startScrollCoordinate.x)/(o>0?o:1)*20;if(o<200&&Math.abs(r)>0){var a=this._chart.getChartStore().getTimeScaleStore(),s=function(){e._flingScrollTimerId=setTimeout((function(){a.startScroll(),a.scroll(r),r*=.975,Math.abs(r)<1?null!==e._flingScrollTimerId&&(clearTimeout(e._flingScrollTimerId),e._flingScrollTimerId=null):s()}),20)};s()}}return!0;case Ht:case jt:i.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}}return!1},t.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===Xt&&null===this._touchCoordinate&&!this._touchCancelCrosshair&&!this._touchZoomed){var o=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getCrosshairStore().set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===Xt){var o=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getCrosshairStore().set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype._findWidgetByEvent=function(t){var e,i,n=this._chart.getAllPanes(),o=t.x,r=t.y,l=null;try{for(var c=a(n),u=c.next();!u.done;u=c.next()){var h=s(u.value,2)[1],d=h.getBounding();if(o>=d.left&&o<=d.left+d.width&&r>=d.top&&r<=d.top+d.height){l=h;break}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}null===l&&(l=this._chart.getPaneById(Kt.XAXIS));var p=null;if(null!==l){var v=l.getSeparatorWidget();if(null!==v){var g=v.getBounding();o>=g.left&&o<=g.left+g.width&&r>=g.top&&r<=g.top+7&&(p=v)}if(null===p){var f=l.getMainWidget(),m=f.getBounding();o>=m.left&&o<=m.left+m.width&&r>=m.top&&r<=m.top+m.height&&(p=f)}if(null===p){var y=l.getYAxisWidget();if(null!==y){var _=y.getBounding();o>=_.left&&o<=_.left+_.width&&r>=_.top&&r<=_.top+_.height&&(p=y)}}}return{pane:l,widget:p}},t.prototype._makeWidgetEvent=function(t,e){var i,o,r,a=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return n(n({},t),{x:t.x-(null!==(o=null==a?void 0:a.left)&&void 0!==o?o:0),y:t.y-(null!==(r=null==a?void 0:a.top)&&void 0!==r?r:0)})},t.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},t}();!function(t){t.Root="root",t.Main="main",t.YAxis="yAxis"}(ai||(ai={}));var ci=function(){function t(t,e){this._panes=new Map,this._initContainer(t),this._chartEvent=new li(this._chartContainer,this),this._chartStore=new ie(this,e),this._xAxisPane=new ni(this._chartContainer,this,Kt.XAXIS),this._panes.set(Kt.CANDLE,new Je(this._chartContainer,this,Kt.CANDLE)),this.adjustPaneViewport(!0,!0,!0)}return t.prototype._initContainer=function(t){this._container=t,this._chartContainer=O("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},t.prototype._measurePaneHeight=function(){var t,e=this._container.offsetHeight,i=this._xAxisPane.getAxisComponent().getAutoSize(),n=e-i;n<0&&(n=0);var o=0;this._panes.forEach((function(t){if(t.getId()!==Kt.CANDLE){var e=t.getBounding().height,i=t.getOptions().minHeight;e<i&&(e=i),o+e>n?(o=n,e=Math.max(n-o,0)):o+=e,t.setBounding({height:e})}}));var r=n-o;null===(t=this._panes.get(Kt.CANDLE))||void 0===t||t.setBounding({height:r});var a=0;this._panes.forEach((function(t){t.setBounding({top:a}),a+=t.getBounding().height})),this._xAxisPane.setBounding({height:i,top:a})},t.prototype._measurePaneWidth=function(){var t=this._chartStore.getStyles().yAxis,e=t.position===b.Left,i=!t.inside,n=this._container.offsetWidth,o=0,r=Number.MIN_SAFE_INTEGER,a=0,s=0;this._panes.forEach((function(t){r=Math.max(r,t.getAxisComponent().getAutoSize())})),r>n&&(r=n),i?(o=n-r,e?(a=0,s=r):(a=n-r,s=0)):(o=n,s=0,a=e?0:n-r),this._chartStore.getTimeScaleStore().setTotalBarSpace(o);var l={width:n},c={width:o,left:s},u={width:r,left:a};this._panes.forEach((function(t){t.setBounding(l,c,u)})),this._xAxisPane.setBounding(l,c,u)},t.prototype._setPaneOptions=function(t,e){var i,n,o=this._panes.get(null!==(i=null==t?void 0:t.id)&&void 0!==i?i:""),r=!1;if(void 0!==o){var a=e;if(t.id!==Kt.CANDLE&&void 0!==t.height&&t.height>0){var s=Math.max(null!==(n=t.minHeight)&&void 0!==n?n:o.getOptions().minHeight,0),l=Math.max(s,t.height);o.setBounding({height:l}),a=!0,r=!0}o.setOptions(t),a&&this.adjustPaneViewport(r,!0,!0,!0,!0)}},t.prototype.getContainer=function(){return this._container},t.prototype.getChartStore=function(){return this._chartStore},t.prototype.getAllPanes=function(){return this._panes},t.prototype.adjustPaneViewport=function(t,e,i,n,o){t&&this._measurePaneHeight();var r=e,a=null!=o&&o;(null!=n&&n||a)&&this._panes.forEach((function(t){var e=t.getAxisComponent().buildTicks(a);r||(r=e)})),r&&this._measurePaneWidth(),null!=i&&i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},t.prototype.updatePane=function(t,e){var i;void 0!==e?null===(i=this.getPaneById(e))||void 0===i||i.update(t):(this._xAxisPane.update(t),this._panes.forEach((function(e){e.update(t)})))},t.prototype.getPaneById=function(t){var e;return t===Kt.XAXIS?this._xAxisPane:null!==(e=this._panes.get(t))&&void 0!==e?e:null},t.prototype.crosshairChange=function(t){var e=this,i=this._chartStore.getActionStore();if(i.has(A.OnCrosshairChange)){var o={};this._panes.forEach((function(i,n){var r={};e._chartStore.getIndicatorStore().getInstances(n).forEach((function(e){var i,n=e.result;r[e.name]=n[null!==(i=t.dataIndex)&&void 0!==i?i:n.length-1]})),o[n]=r})),void 0!==t.paneId&&i.execute(A.OnCrosshairChange,n(n({},t),{indicatorData:o}))}},t.prototype.getDom=function(t,e){var i,n;if(void 0===t)return this._chartContainer;var o=this.getPaneById(t);if(null!==o)switch(null!=e?e:ai.Root){case ai.Root:return o.getContainer();case ai.Main:return o.getMainWidget().getContainer();case ai.YAxis:return null!==(n=null===(i=o.getYAxisWidget())||void 0===i?void 0:i.getContainer())&&void 0!==n?n:null}return null},t.prototype.getSize=function(t,e){var i,n;if(void 0===t)return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var o=this.getPaneById(t);if(null!==o)switch(null!=e?e:ai.Root){case ai.Root:return o.getBounding();case ai.Main:return o.getMainWidget().getBounding();case ai.YAxis:return null!==(n=null===(i=o.getYAxisWidget())||void 0===i?void 0:i.getBounding())&&void 0!==n?n:null}return null},t.prototype.setStyles=function(t){var e,i,n;this._chartStore.setOptions({styles:t}),void 0!==(null===(e=null==(n=f(t)?ee(t):t)?void 0:n.yAxis)||void 0===e?void 0:e.type)&&(null===(i=this.getPaneById(Kt.CANDLE))||void 0===i||i.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},t.prototype.getStyles=function(){return this._chartStore.getStyles()},t.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},t.prototype.getLocale=function(){return this._chartStore.getLocale()},t.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},t.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},t.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},t.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},t.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},t.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},t.prototype.setLeftMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},t.prototype.setRightMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},t.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},t.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},t.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},t.prototype.clearData=function(){this._chartStore.clearDataList()},t.prototype.getDataList=function(){return this._chartStore.getDataList()},t.prototype.applyNewData=function(t,e){this._chartStore.clearDataList(),this.applyMoreData(t,e)},t.prototype.applyMoreData=function(t,e){var i=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then((function(t){i.adjustPaneViewport(!1,!0,!0,!0)})).catch((function(t){}))},t.prototype.updateData=function(t){var e=this,i=this._chartStore.getDataList(),n=i.length,o=t.timestamp,r=D(i[n-1],"timestamp",0);if(o>=r){var a=n;o===r&&(a=n-1),this._chartStore.addData(t,a),this._chartStore.getIndicatorStore().calcInstance().then((function(t){e.adjustPaneViewport(!1,!0,!0,!0)})).catch((function(t){}))}},t.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},t.prototype.createIndicator=function(t,e,i,n){var o,r,a,s=this,l=f(t)?{name:t}:t;if(null===xt(l.name))return null;if(void 0!==(null==i?void 0:i.id)&&this._panes.has(i.id))a=i.id,this._chartStore.getIndicatorStore().addInstance(l,a,null!=e&&e).then((function(t){var e,n;s._setPaneOptions(i,null!==(n=null===(e=s._panes.get(a))||void 0===e?void 0:e.getAxisComponent().buildTicks(!0))&&void 0!==n&&n)})).catch((function(t){}));else{a=null!==(o=null==i?void 0:i.id)&&void 0!==o?o:N(Kt.INDICATOR);var c=Array.from(this._panes.values()).pop(),u=new Ke(this._chartContainer,this,a,c);c.setBottomPane(u);var h=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:100;u.setBounding({height:h}),null!=i&&u.setOptions(i),this._panes.set(a,u),this._chartStore.getIndicatorStore().addInstance(l,a,null!=e&&e).finally((function(){s.adjustPaneViewport(!0,!0,!0,!0,!0),null==n||n()}))}return a},t.prototype.overrideIndicator=function(t,e,i){var n=this;this._chartStore.getIndicatorStore().override(t,null!=e?e:null).then((function(t){var e=s(t,2),o=e[0],r=e[1];(o||r)&&(n.adjustPaneViewport(!1,r,!0,r),null==i||i())})).catch((function(){}))},t.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},t.prototype.removeIndicator=function(t,e){var i=this._chartStore.getIndicatorStore();if(i.removeInstance(t,e)){var n=!1;if(t!==Kt.CANDLE&&!i.hasInstances(t)){var o=this._panes.get(t);if(void 0!==o){n=!0;var r=o.getTopPane(),a=o.getBottomPane();null==a||a.setTopPane(r),null==r||r.setBottomPane(a),null==o||o.destroy(),this._panes.delete(t)}}this.adjustPaneViewport(n,!0,!0,!0,!0)}},t.prototype.createOverlay=function(t,e){var i=f(t)?{name:t}:t;if(null===Wt(i.name))return null;var n=!0;return void 0!==e&&null!==this.getPaneById(e)||(e=Kt.CANDLE,n=!1),this._chartStore.getOverlayStore().addInstance(i,e,n)},t.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},t.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},t.prototype.removeOverlay=function(t){var e;void 0!==t&&(e=f(t)?{id:t}:t),this._chartStore.getOverlayStore().removeInstance(e)},t.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},t.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},t.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},t.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},t.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},t.prototype.scrollByDistance=function(t,e){var i=void 0===e||e<0?0:e,n=this._chartStore.getTimeScaleStore();if(i>0){n.startScroll();var o=(new Date).getTime(),r=function(){var e=((new Date).getTime()-o)/i,a=e>=1,s=a?t:t*e;n.scroll(s),a||requestAnimationFrame(r)};r()}else n.startScroll(),n.scroll(t)},t.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,n=(e.getOffsetRightBarCount()-e.getOffsetRightDistance()/i)*i;this.scrollByDistance(n,t)},t.prototype.scrollToDataIndex=function(t,e){var i=this._chartStore.getTimeScaleStore(),n=(i.getOffsetRightBarCount()+(this.getDataList().length-1-t))*i.getBarSpace().bar;this.scrollByDistance(n,e)},t.prototype.scrollToTimestamp=function(t,e){var i=Y(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},t.prototype.zoomAtCoordinate=function(t,e,i){var n=void 0===i||i<0?0:i,o=this._chartStore.getTimeScaleStore();if(n>0){var r=o.getBarSpace().bar,a=r*t-r,s=(new Date).getTime(),l=function(){var t=((new Date).getTime()-s)/n,i=t>=1,c=i?a:a*t;o.zoom(c/r,e),i||requestAnimationFrame(l)};l()}else o.zoom(t,e)},t.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},t.prototype.zoomAtTimestamp=function(t,e,i){var n=Y(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},t.prototype.convertToPixel=function(t,e){var i,n=e.paneId,o=void 0===n?Kt.CANDLE:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==Kt.XAXIS){var l=this.getPaneById(o);if(null!==l){var c=this._chartStore.getTimeScaleStore(),u=l.getBounding(),d=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),v=l.getAxisComponent();s=d.map((function(t){var e={},i=t.dataIndex;if(void 0!==t.timestamp&&(i=c.timestampToDataIndex(t.timestamp)),void 0!==i&&(e.x=null==p?void 0:p.convertToPixel(i)),void 0!==t.value){var n=null==v?void 0:v.convertToPixel(t.value);e.y=a?u.top+n:n}return e}))}}return h(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},t.prototype.convertFromPixel=function(t,e){var i,n=e.paneId,o=void 0===n?Kt.CANDLE:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==Kt.XAXIS){var l=this.getPaneById(o);if(null!==l){var c=this._chartStore.getTimeScaleStore(),u=l.getBounding(),d=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),v=l.getAxisComponent();s=d.map((function(t){var e,i={};if(void 0!==t.x){var n=p.convertFromPixel(t.x);i.dataIndex=n,i.timestamp=null!==(e=c.dataIndexToTimestamp(n))&&void 0!==e?e:void 0}if(void 0!==t.y){var o=a?t.y-u.top:t.y;i.value=v.convertFromPixel(o)}return i}))}}return h(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},t.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},t.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},t.prototype.getConvertPictureUrl=function(t,e,i){var n=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight,r=O("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=V(r);r.width=n*s,r.height=o*s,a.scale(s,s),a.fillStyle=null!=i?i:"#FFFFFF",a.fillRect(0,0,n,o);var l=null!=t&&t;this._panes.forEach((function(t){var e=t.getBounding();a.drawImage(t.getImage(l),0,e.top,n,e.height)}));var c=this._xAxisPane.getBounding();return a.drawImage(this._xAxisPane.getImage(l),0,c.top,n,c.height),r.toDataURL("image/".concat(null!=e?e:"jpeg"))},t.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},t.prototype.destroy=function(){this._chartEvent.destroy(),this._panes.forEach((function(t){t.destroy()})),this._panes.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer)},t}(),ui={},hi=1,di={clone:u,merge:c,isString:f,isNumber:v,isValid:g,isObject:p,isArray:h,isFunction:d,isBoolean:function(t){return"boolean"==typeof t},formatValue:D,formatPrecision:P,formatBigNumber:k,formatDate:M,getLinearSlopeIntercept:At,getLinearYFromSlopeIntercept:Pt,getLinearYFromCoordinates:kt,checkCoordinateOnArc:function(t,e){if(Math.abs((u=e,h=(c=t).x-u.x,d=c.y-u.y,Math.sqrt(h*h+d*d)-e.r))<se){var i=e.r,n=e.startAngle,o=e.endAngle,r=i*Math.cos(n)+e.x,a=i*Math.sin(n)+e.y,s=i*Math.cos(o)+e.x,l=i*Math.sin(o)+e.y;return t.x<=Math.max(r,s)+se&&t.x>=Math.min(r,s)-se&&t.y<=Math.max(a,l)+se&&t.y>=Math.min(a,l)-se}var c,u,h,d;return!1},checkCoordinateOnCircle:ce,checkCoordinateOnLine:Mt,checkCoordinateOnPolygon:de,checkCoordinateOnRect:ge,checkCoordinateOnText:_e,drawArc:function(t,e,i){var n=e.x,o=e.y,r=e.r,a=e.startAngle,s=e.endAngle,l=i.style,c=void 0===l?m.Solid:l,u=i.size,h=void 0===u?1:u,d=i.color,p=void 0===d?"currentColor":d,v=i.dashedValue,g=void 0===v?[2,2]:v;t.lineWidth=h,t.strokeStyle=p,c===m.Dashed?t.setLineDash(g):t.setLineDash([]),t.beginPath(),t.arc(n,o,r,a,s),t.stroke(),t.closePath()},drawCircle:ue,drawLine:Ft,drawPolygon:pe,drawRect:fe,drawText:xe,drawRectText:Ce};t.dispose=function(t){var e,i;if(f(t)){var n=document.getElementById(t);i=null!==(e=null==n?void 0:n.getAttribute("chartId"))&&void 0!==e?e:null}else i=t instanceof ci?t.id:null!=t?t:t.chartId;null!==i&&(ui[i].destroy(),delete ui[i])},t.getFigureClass=function(t){var e;return null!==(e=we[t])&&void 0!==e?e:null},t.getSupportedFigures=function(){return Object.keys(we)},t.getSupportedIndicators=function(){return Object.keys(yt)},t.getSupportedLocales=function(){return Object.keys(Ne)},t.getSupportedOverlays=function(){return Object.keys(Vt)},t.init=function(t,e){var i,n;if(null===(n=f(t)?document.getElementById(t):t))return null;var o=ui[null!==(i=n.chartId)&&void 0!==i?i:""];if(void 0!==o)return o;var r="k_line_chart_".concat(hi++);return(o=new ci(n,e)).id=r,n.chartId=r,ui[r]=o,o},t.registerFigure=function(t){we[t.name]=le.extend(t)},t.registerIndicator=function(t){yt[t.name]=tt.extend(t)},t.registerLocale=function(t,e){Ne[t]=n(n({},Ne[t]),e)},t.registerOverlay=function(t){Vt[t.name]=Et.extend(t)},t.registerStyles=function(t,e){te[t]=e},t.utils=di,t.version=function(){return"9.0.0"}}))},NGis:function(t,e,i){"use strict";t.exports=i("Ds32")}}]);